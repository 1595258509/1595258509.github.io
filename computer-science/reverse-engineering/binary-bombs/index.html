<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta http-equiv="X-UA-COMPATIBLE" content="IE=edge,chrome=1"><meta name="renderer" content="webkit"><link rel="icon" type="image/ico" sizes="32x32" href="/assets/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="alternate" href="/rss.xml" title="MurlorsのBlog" type="application/rss+xml"><link rel="alternate" href="/atom.xml" title="MurlorsのBlog" type="application/atom+xml"><link rel="alternate" type="application/json" title="MurlorsのBlog" href="https://murlors.netlify.app/feed.json"><link rel="preconnect" href="https://lf9-cdn-tos.bytecdntp.com"><link rel="preconnect" href="https://at.alicdn.com"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CFredericka%20the%20Great:400,400italic,700,700italic%7CNoto%20Serif%20JP:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic%7CInconsolata:400,400italic,700,700italic&amp;display=swap&amp;subset=latin,latin-ext" media="none" onload="this.media='all'"><link rel="stylesheet" href="/css/app.css?v=0.4.5"><link rel="modulepreload" href="/js/chunk-B3ZCFIDY.js"><link rel="modulepreload" href="/js/chunk-I4XZHGPZ.js"><link rel="modulepreload" href="/js/chunk-NDWTHW2J.js"><link rel="modulepreload" href="/js/chunk-PGETBWSZ.js"><link rel="modulepreload" href="/js/chunk-XSZTLZYS.js"><link rel="modulepreload" href="/js/comments-XOZAX3P4.js"><link rel="modulepreload" href="/js/index.esm-AFEUA67J.js"><link rel="modulepreload" href="/js/post-VEPI32PL.js"><link rel="modulepreload" href="/js/quicklink-EBQZEAZB.js"><link rel="modulepreload" href="/js/search-JYPNEK7T.js"><link rel="modulepreload" href="/js/siteInit.js"><link rel="stylesheet" href="https://npm.webcache.cn/@waline/client@3.0.0-alpha.11/dist/waline.css" media="none" onload="this.media='all'"><link rel="preload" href="https://t.alcy.cc/moe/?postId=25" as="image" fetchpriority="high"><link rel="preload" href="https://t.alcy.cc/moe/?postId=41" as="image" fetchpriority="high"><link rel="preload" href="https://t.alcy.cc/ycy/?postId=5" as="image" fetchpriority="high"><link rel="preload" href="https://t.alcy.cc/moe/?postId=44" as="image" fetchpriority="high"><link rel="preload" href="https://t.alcy.cc/moe/?postId=39" as="image" fetchpriority="high"><link rel="preload" href="https://t.alcy.cc/ycy/?postId=2" as="image" fetchpriority="high"><meta name="keywords" content="Reverse-Engineering,"><meta name="description" content="Hi, I'm Murlors."><link rel="canonical" href="https://murlors.netlify.app/computer-science/reverse-engineering/binary-bombs/"><title>Binary Bombs | 二进制炸弹</title><meta name="generator" content="Hexo 7.2.0"></head><body itemscope="" itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Binary Bombs | 二进制炸弹</h1><div class="meta"><span class="item" title="创建时间：2023-05-13 15:30:00"><span class="icon"><i class="ic i-calendar"></i></span><span class="text">发表于</span><time itemprop="dateCreated datePublished" datetime="2023-05-13T15:30:00+08:00">2023-05-13</time></span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i></span><span class="text">本文字数</span><span>40k</span><span class="text">字</span></span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i></span><span class="text">阅读时长</span><span>36 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span><span class="line"></span><span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Murlors</a></li></ul><ul class="right" id="rightNav"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div class="pjax" id="imgs"><ul><li class="item" style="background-image: url(&quot;https://t.alcy.cc/moe/?postId=25&quot;);"></li><li class="item" style="background-image: url(&quot;https://t.alcy.cc/moe/?postId=41&quot;);"></li><li class="item" style="background-image: url(&quot;https://t.alcy.cc/ycy/?postId=5&quot;);"></li><li class="item" style="background-image: url(&quot;https://t.alcy.cc/moe/?postId=44&quot;);"></li><li class="item" style="background-image: url(&quot;https://t.alcy.cc/moe/?postId=39&quot;);"></li><li class="item" style="background-image: url(&quot;https://t.alcy.cc/ycy/?postId=2&quot;);"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"></use><use xlink:href="#gentle-wave" x="48" y="3"></use><use xlink:href="#gentle-wave" x="48" y="5"></use><use xlink:href="#gentle-wave" x="48" y="7"></use></g></svg></div><main><div class="inner"><div class="pjax" id="main"><div class="article wrap"><div class="breadcrumb" itemlistelement="" itemscope="" itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i><span><a href="/">首页</a></span><i class="ic i-angle-right"></i><span itemprop="itemListElement" itemscope="itemscope" itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/" itemprop="item" rel="index" title="分类于计算机科学"><span itemprop="name">计算机科学<meta itemprop="position" content="0"></span></a></span><i class="ic i-angle-right"></i><span class="current" itemprop="itemListElement" itemscope="itemscope" itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/Reverse-Engineering/" itemprop="item" rel="index" title="分类于Reverse-Engineering"><span itemprop="name">Reverse-Engineering<meta itemprop="position" content="1"></span></a></span></div><article class="post block" itemscope="itemscope" itemtype="http://schema.org/Article" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://murlors.netlify.app/computer-science/reverse-engineering/binary-bombs/"><span hidden="hidden" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><meta itemprop="image" content="/assets/avatar.jpg"><meta itemprop="name" content="Murlors"><meta itemprop="description" content=", Hi, I'm Murlors."></span><span hidden="hidden" itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Organization"><meta itemprop="name" content="MurlorsのBlog"></span><div class="body md" itemprop="articleBody"><h1 id="准备工作"><a class="anchor" href="#准备工作">#</a> 准备工作</h1>
<p>首先我们打开 <code>bomb.c</code> :</p>
<figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre><span class="token comment">/***************************************************************************</span></pre></td></tr><tr><td data-num="2"></td><td><pre> * Dr. Evil's Insidious Bomb, Version 1.1</pre></td></tr><tr><td data-num="3"></td><td><pre> * Copyright 2011, Dr. Evil Incorporated. All rights reserved.</pre></td></tr><tr><td data-num="4"></td><td><pre> *</pre></td></tr><tr><td data-num="5"></td><td><pre> * LICENSE:</pre></td></tr><tr><td data-num="6"></td><td><pre> *</pre></td></tr><tr><td data-num="7"></td><td><pre> * Dr. Evil Incorporated (the PERPETRATOR) hereby grants you (the</pre></td></tr><tr><td data-num="8"></td><td><pre> * VICTIM) explicit permission to use this bomb (the BOMB).  This is a</pre></td></tr><tr><td data-num="9"></td><td><pre> * time limited license, which expires on the death of the VICTIM.</pre></td></tr><tr><td data-num="10"></td><td><pre> * The PERPETRATOR takes no responsibility for damage, frustration,</pre></td></tr><tr><td data-num="11"></td><td><pre> * insanity, bug-eyes, carpal-tunnel syndrome, loss of sleep, or other</pre></td></tr><tr><td data-num="12"></td><td><pre> * harm to the VICTIM.  Unless the PERPETRATOR wants to take credit,</pre></td></tr><tr><td data-num="13"></td><td><pre> * that is.  The VICTIM may not distribute this bomb source code to</pre></td></tr><tr><td data-num="14"></td><td><pre> * any enemies of the PERPETRATOR.  No VICTIM may debug,</pre></td></tr><tr><td data-num="15"></td><td><pre> * reverse-engineer, run "strings" on, decompile, decrypt, or use any</pre></td></tr><tr><td data-num="16"></td><td><pre> * other technique to gain knowledge of and defuse the BOMB.  BOMB</pre></td></tr><tr><td data-num="17"></td><td><pre> * proof clothing may not be worn when handling this program.  The</pre></td></tr><tr><td data-num="18"></td><td><pre> * PERPETRATOR will not apologize for the PERPETRATOR's poor sense of</pre></td></tr><tr><td data-num="19"></td><td><pre> * humor.  This license is null and void where the BOMB is prohibited</pre></td></tr><tr><td data-num="20"></td><td><pre> * by law.</pre></td></tr><tr><td data-num="21"></td><td><pre> ***************************************************************************/</pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span></pre></td></tr><tr><td data-num="24"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"support.h"</span></span></pre></td></tr><tr><td data-num="26"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"phases.h"</span></span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre><span class="token comment">/* </span></pre></td></tr><tr><td data-num="29"></td><td><pre> * Note to self: Remember to erase this file so my victims will have no</pre></td></tr><tr><td data-num="30"></td><td><pre> * idea what is going on, and so they will all blow up in a</pre></td></tr><tr><td data-num="31"></td><td><pre> * spectaculary fiendish explosion. -- Dr. Evil </pre></td></tr><tr><td data-num="32"></td><td><pre> */</pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>FILE <span class="token operator">*</span>infile<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="35"></td><td><pre></pre></td></tr><tr><td data-num="36"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">{</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    <span class="token keyword">char</span> <span class="token operator">*</span>input<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="39"></td><td><pre></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token comment">/* Note to self: remember to port this bomb to Windows and put a </span></pre></td></tr><tr><td data-num="41"></td><td><pre>     * fantastic GUI on it. */</pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre>    <span class="token comment">/* When run with no arguments, the bomb reads its input lines </span></pre></td></tr><tr><td data-num="44"></td><td><pre>     * from standard input. */</pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  </pre></td></tr><tr><td data-num="46"></td><td><pre>    infile <span class="token operator">=</span> <span class="token constant">stdin</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token punctuation">}</span> </pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token comment">/* When run with one argument &lt;file&gt;, the bomb reads from &lt;file&gt; </span></pre></td></tr><tr><td data-num="50"></td><td><pre>     * until EOF, and then switches to standard input. Thus, as you </pre></td></tr><tr><td data-num="51"></td><td><pre>     * defuse each phase, you can add its defusing string to &lt;file&gt; and</pre></td></tr><tr><td data-num="52"></td><td><pre>     * avoid having to retype it. */</pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>infile <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre></td></tr><tr><td data-num="55"></td><td><pre>        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"%s: Error: Couldn't open %s\n"</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>        <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token punctuation">}</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    <span class="token punctuation">}</span></pre></td></tr><tr><td data-num="59"></td><td><pre></pre></td></tr><tr><td data-num="60"></td><td><pre>    <span class="token comment">/* You can't call the bomb with more than 1 command line argument. */</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token keyword">else</span> <span class="token punctuation">{</span></pre></td></tr><tr><td data-num="62"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Usage: %s [&lt;input_file&gt;]\n"</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="64"></td><td><pre>    <span class="token punctuation">}</span></pre></td></tr><tr><td data-num="65"></td><td><pre></pre></td></tr><tr><td data-num="66"></td><td><pre>    <span class="token comment">/* Do all sorts of secret stuff that makes the bomb harder to defuse. */</span></pre></td></tr><tr><td data-num="67"></td><td><pre>    <span class="token function">initialize_bomb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="68"></td><td><pre></pre></td></tr><tr><td data-num="69"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Welcome to my fiendish little bomb. You have 6 phases with\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="70"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"which to blow yourself up. Have a nice day!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="71"></td><td><pre></pre></td></tr><tr><td data-num="72"></td><td><pre>    <span class="token comment">/* Hmm...  Six phases must be more secure than one phase! */</span></pre></td></tr><tr><td data-num="73"></td><td><pre>    input <span class="token operator">=</span> <span class="token function">read_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>             <span class="token comment">/* Get input                   */</span></pre></td></tr><tr><td data-num="74"></td><td><pre>    <span class="token function">phase_1</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">/* Run the phase               */</span></pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token function">phase_defused</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                 <span class="token comment">/* Drat!  They figured it out!</span></pre></td></tr><tr><td data-num="76"></td><td><pre>                      * Let me know how they did it. */</pre></td></tr><tr><td data-num="77"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Phase 1 defused. How about the next one?\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="78"></td><td><pre></pre></td></tr><tr><td data-num="79"></td><td><pre>    <span class="token comment">/* The second phase is harder.  No one will ever figure out</span></pre></td></tr><tr><td data-num="80"></td><td><pre>     * how to defuse this... */</pre></td></tr><tr><td data-num="81"></td><td><pre>    input <span class="token operator">=</span> <span class="token function">read_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="82"></td><td><pre>    <span class="token function">phase_2</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="83"></td><td><pre>    <span class="token function">phase_defused</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="84"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"That's number 2.  Keep going!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="85"></td><td><pre></pre></td></tr><tr><td data-num="86"></td><td><pre>    <span class="token comment">/* I guess this is too easy so far.  Some more complex code will</span></pre></td></tr><tr><td data-num="87"></td><td><pre>     * confuse people. */</pre></td></tr><tr><td data-num="88"></td><td><pre>    input <span class="token operator">=</span> <span class="token function">read_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="89"></td><td><pre>    <span class="token function">phase_3</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="90"></td><td><pre>    <span class="token function">phase_defused</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="91"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Halfway there!\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="92"></td><td><pre></pre></td></tr><tr><td data-num="93"></td><td><pre>    <span class="token comment">/* Oh yeah?  Well, how good is your math?  Try on this saucy problem! */</span></pre></td></tr><tr><td data-num="94"></td><td><pre>    input <span class="token operator">=</span> <span class="token function">read_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="95"></td><td><pre>    <span class="token function">phase_4</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="96"></td><td><pre>    <span class="token function">phase_defused</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="97"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"So you got that one.  Try this one.\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="98"></td><td><pre>    </pre></td></tr><tr><td data-num="99"></td><td><pre>    <span class="token comment">/* Round and 'round in memory we go, where we stop, the bomb blows! */</span></pre></td></tr><tr><td data-num="100"></td><td><pre>    input <span class="token operator">=</span> <span class="token function">read_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="101"></td><td><pre>    <span class="token function">phase_5</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="102"></td><td><pre>    <span class="token function">phase_defused</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="103"></td><td><pre>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Good work!  On to the next...\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="104"></td><td><pre></pre></td></tr><tr><td data-num="105"></td><td><pre>    <span class="token comment">/* This phase will never be used, since no one will get past the</span></pre></td></tr><tr><td data-num="106"></td><td><pre>     * earlier ones.  But just in case, make this one extra hard. */</pre></td></tr><tr><td data-num="107"></td><td><pre>    input <span class="token operator">=</span> <span class="token function">read_line</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="108"></td><td><pre>    <span class="token function">phase_6</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="109"></td><td><pre>    <span class="token function">phase_defused</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="110"></td><td><pre></pre></td></tr><tr><td data-num="111"></td><td><pre>    <span class="token comment">/* Wow, they got it!  But isn't something... missing?  Perhaps</span></pre></td></tr><tr><td data-num="112"></td><td><pre>     * something they overlooked?  Mua ha ha ha ha! */</pre></td></tr><tr><td data-num="113"></td><td><pre>    </pre></td></tr><tr><td data-num="114"></td><td><pre>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="115"></td><td><pre><span class="token punctuation">}</span></pre></td></tr></tbody></table></figure><p>可以看到有 6 个 phase，每个 phase 基本都是要我们输入一行字符，然后它调用了判断我们的输入是否正确的函数。<br>
知道要干什么之后把 bomb 文件反汇编一下:</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>objdump <span class="token parameter variable">-d</span> bomb <span class="token operator">&gt;</span> bomb.asm</pre></td></tr></tbody></table></figure><p>得到了 bomb 的反汇编文件 <code>bomb.asm</code> ，然后就可以着手分析了。<br>
在反汇编文件中搜索 phase，找到了各个 phase 所在地，就可以用 GDB 来进行调试了。</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>gdb bomb</pre></td></tr></tbody></table></figure><p>然后在 gdb 中输入 <code>disas phase_1</code> ，就可以看到 phase_1 的反汇编代码了，如下所示：</p>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>(gdb) disas phase_1</pre></td></tr><tr><td data-num="2"></td><td><pre>Dump of assembler code for function phase_1:</pre></td></tr><tr><td data-num="3"></td><td><pre>   <span class="token number">0x08048bce</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">0</span><span class="token operator">&gt;</span>:     push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre>   <span class="token number">0x08048bcf</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">&gt;</span>:     mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="5"></td><td><pre>   <span class="token number">0x08048bd1</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">3</span><span class="token operator">&gt;</span>:     sub    <span class="token operator">$</span><span class="token number">0x18</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="6"></td><td><pre>   <span class="token number">0x08048bd4</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">6</span><span class="token operator">&gt;</span>:     movl   <span class="token operator">$</span><span class="token number">0x804a354</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="7"></td><td><pre>   <span class="token number">0x08048bdc</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">14</span><span class="token operator">&gt;</span>:    mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="8"></td><td><pre>   <span class="token number">0x08048bdf</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">17</span><span class="token operator">&gt;</span>:    mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="9"></td><td><pre>   <span class="token number">0x08048be2</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">20</span><span class="token operator">&gt;</span>:    call   <span class="token number">0x804915a</span> <span class="token operator">&lt;</span>strings_not_equal<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>   <span class="token number">0x08048be7</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">25</span><span class="token operator">&gt;</span>:    test   <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="11"></td><td><pre>   <span class="token number">0x08048be9</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">27</span><span class="token operator">&gt;</span>:    je     <span class="token number">0x8048bf0</span> <span class="token operator">&lt;</span>phase_1<span class="token operator">+</span><span class="token number">34</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="12"></td><td><pre>   <span class="token number">0x08048beb</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">29</span><span class="token operator">&gt;</span>:    call   <span class="token number">0x80493bd</span> <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>   <span class="token number">0x08048bf0</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">34</span><span class="token operator">&gt;</span>:    leave</pre></td></tr><tr><td data-num="14"></td><td><pre>   <span class="token number">0x08048bf1</span> <span class="token operator">&lt;</span><span class="token operator">+</span><span class="token number">35</span><span class="token operator">&gt;</span>:    ret</pre></td></tr><tr><td data-num="15"></td><td><pre>End of assembler dump.</pre></td></tr></tbody></table></figure><p>给爆炸和 phase_1 打上断点</p>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>(gdb) b explode_bomb</pre></td></tr><tr><td data-num="2"></td><td><pre>Breakpoint <span class="token number">1</span> at <span class="token number">0x80493c3</span></pre></td></tr><tr><td data-num="3"></td><td><pre>(gdb) b phase_1</pre></td></tr><tr><td data-num="4"></td><td><pre>Breakpoint <span class="token number">2</span> at <span class="token number">0x8048bd4</span></pre></td></tr></tbody></table></figure><h1 id="phase_1"><a class="anchor" href="#phase_1">#</a> phase_1</h1>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>08048bce <span class="token operator">&lt;</span>phase_1<span class="token operator">&gt;</span>:</pre></td></tr><tr><td data-num="2"></td><td><pre> 8048bce: <span class="token number">55</span>                    push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="3"></td><td><pre> 8048bcf: <span class="token number">89</span> e5                 mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre> 8048bd1: <span class="token number">83</span> ec <span class="token number">18</span>              sub    <span class="token operator">$</span><span class="token number">0x18</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="5"></td><td><pre> 8048bd4: c7 <span class="token number">44</span> <span class="token number">24</span> <span class="token number">04</span> <span class="token number">54</span> a3 <span class="token number">04</span>  movl   <span class="token operator">$</span><span class="token number">0x804a354</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="6"></td><td><pre> 8048bdb: <span class="token number">08</span> </pre></td></tr><tr><td data-num="7"></td><td><pre> 8048bdc: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="8"></td><td><pre> 8048bdf: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="9"></td><td><pre> 8048be2: e8 <span class="token number">73</span> <span class="token number">05</span> <span class="token number">00</span> <span class="token number">00</span>        call   804915a <span class="token operator">&lt;</span>strings_not_equal<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="10"></td><td><pre> 8048be7: <span class="token number">85</span> c0                 test   <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="11"></td><td><pre> 8048be9: <span class="token number">74</span> <span class="token number">05</span>                 je     8048bf0 <span class="token operator">&lt;</span>phase_1<span class="token operator">+</span><span class="token number">0x22</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="12"></td><td><pre> 8048beb: e8 cd <span class="token number">07</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="13"></td><td><pre> 8048bf0: c9                    leave</pre></td></tr><tr><td data-num="14"></td><td><pre> 8048bf1: c3                    ret</pre></td></tr></tbody></table></figure><p>调用 <code>string_not_equal</code>  函数判断输入的字符串与存储在 <code>0x804a354</code>  处的字符串是否相等，若相等（所调用函数为 0）炸弹就不会炸。</p>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>(gdb) x <span class="token operator">/</span>s <span class="token number">0x804a354</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">0x804a354</span>:      <span class="token string">"I am the mayor. I can do anything I want."</span></pre></td></tr></tbody></table></figure><p>所以本关的答案就是 <code>0x804a354</code>  处的字符串，只需通过 gdb 得到该地址的字符串即可。</p>
<p><img loading="lazy" data-src="https://s2.loli.net/2023/05/13/W43xByDoRJA9tzl.png" alt=""></p>
<h1 id="phase_2"><a class="anchor" href="#phase_2">#</a> phase_2</h1>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>08048bf2 <span class="token operator">&lt;</span>phase_2<span class="token operator">&gt;</span>:</pre></td></tr><tr><td data-num="2"></td><td><pre> 8048bf2: <span class="token number">55</span>                    push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="3"></td><td><pre> 8048bf3: <span class="token number">89</span> e5                 mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre> 8048bf5: <span class="token number">83</span> ec <span class="token number">38</span>              sub    <span class="token operator">$</span><span class="token number">0x38</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="5"></td><td><pre> 8048bf8: <span class="token number">8d</span> <span class="token number">45</span> dc              lea    <span class="token operator">-</span><span class="token number">0x24</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="6"></td><td><pre> 8048bfb: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> <span class="token number">04</span>           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="7"></td><td><pre> 8048bff: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="8"></td><td><pre> 8048c02: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="9"></td><td><pre> 8048c05: e8 bb <span class="token number">04</span> <span class="token number">00</span> <span class="token number">00</span>        call   80490c5 <span class="token operator">&lt;</span>read_six_numbers<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="10"></td><td><pre> 8048c0a: 8b <span class="token number">45</span> dc              mov    <span class="token operator">-</span><span class="token number">0x24</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="11"></td><td><pre> 8048c0d: <span class="token number">85</span> c0                 test   <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="12"></td><td><pre> 8048c0f: <span class="token number">75</span> <span class="token number">08</span>                 jne    8048c19 <span class="token operator">&lt;</span>phase_2<span class="token operator">+</span><span class="token number">0x27</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="13"></td><td><pre> 8048c11: 8b <span class="token number">45</span> e0              mov    <span class="token operator">-</span><span class="token number">0x20</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="14"></td><td><pre> 8048c14: <span class="token number">83</span> f8 <span class="token number">01</span>              cmp    <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="15"></td><td><pre> 8048c17: <span class="token number">74</span> <span class="token number">05</span>                 je     8048c1e <span class="token operator">&lt;</span>phase_2<span class="token operator">+</span><span class="token number">0x2c</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="16"></td><td><pre> 8048c19: e8 9f <span class="token number">07</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="17"></td><td><pre> 8048c1e: c7 <span class="token number">45</span> f4 <span class="token number">02</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x2</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="18"></td><td><pre> 8048c25: eb 2a                 jmp    8048c51 <span class="token operator">&lt;</span>phase_2<span class="token operator">+</span><span class="token number">0x5f</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="19"></td><td><pre> 8048c27: 8b <span class="token number">45</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="20"></td><td><pre> 8048c2a: 8b <span class="token number">44</span> <span class="token number">85</span> dc           mov    <span class="token operator">-</span><span class="token number">0x24</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>,<span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">4</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="21"></td><td><pre> 8048c2e: 8b <span class="token number">55</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="22"></td><td><pre> 8048c31: <span class="token number">83</span> ea <span class="token number">02</span>              sub    <span class="token operator">$</span><span class="token number">0x2</span>,<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="23"></td><td><pre> 8048c34: 8b 4c <span class="token number">95</span> dc           mov    <span class="token operator">-</span><span class="token number">0x24</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>,<span class="token operator">%</span><span class="token register variable">edx</span>,<span class="token number">4</span>),<span class="token operator">%</span><span class="token register variable">ecx</span></pre></td></tr><tr><td data-num="24"></td><td><pre> 8048c38: 8b <span class="token number">55</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="25"></td><td><pre> 8048c3b: <span class="token number">83</span> ea <span class="token number">01</span>              sub    <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="26"></td><td><pre> 8048c3e: 8b <span class="token number">54</span> <span class="token number">95</span> dc           mov    <span class="token operator">-</span><span class="token number">0x24</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>,<span class="token operator">%</span><span class="token register variable">edx</span>,<span class="token number">4</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="27"></td><td><pre> 8048c42: <span class="token number">01</span> ca                 add    <span class="token operator">%</span><span class="token register variable">ecx</span>,<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="28"></td><td><pre> 8048c44: <span class="token number">39</span> d0                 cmp    <span class="token operator">%</span><span class="token register variable">edx</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="29"></td><td><pre> 8048c46: <span class="token number">74</span> <span class="token number">05</span>                 je     8048c4d <span class="token operator">&lt;</span>phase_2<span class="token operator">+</span><span class="token number">0x5b</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="30"></td><td><pre> 8048c48: e8 <span class="token number">70</span> <span class="token number">07</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="31"></td><td><pre> 8048c4d: <span class="token number">83</span> <span class="token number">45</span> f4 <span class="token number">01</span>           addl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="32"></td><td><pre> 8048c51: <span class="token number">83</span> <span class="token number">7d</span> f4 <span class="token number">05</span>           cmpl   <span class="token operator">$</span><span class="token number">0x5</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="33"></td><td><pre> 8048c55: 7e d0                 jle    8048c27 <span class="token operator">&lt;</span>phase_2<span class="token operator">+</span><span class="token number">0x35</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="34"></td><td><pre> 8048c57: c9                    leave</pre></td></tr><tr><td data-num="35"></td><td><pre> 8048c58: c3                    ret</pre></td></tr></tbody></table></figure><p>首先调用 <code>read_six_numbers</code> ，获取六个整数，然后检查第一个整数是否为 0，再检查第二个整数是否为 1，然后进入一个循环，每次迭代时检查下一个整数是否等于前两个整数之和，如果以上条件有一个不满足，则会调用 <code>explode_bomb</code>  函数，炸弹直接爆炸，反之所有整数都满足条件，则函数正常返回。</p>
<p>所以我们需要做的便是构造一个 0、1 开始的斐波那契数列，因而最后的答案为 <code>0 1 1 2 3 5</code> 。</p>
<p><img loading="lazy" data-src="https://s2.loli.net/2023/05/13/8IveKOk7MLEFmzs.png" alt=""></p>
<h1 id="phase_3"><a class="anchor" href="#phase_3">#</a> phase_3</h1>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>08048c59 <span class="token operator">&lt;</span>phase_3<span class="token operator">&gt;</span>:</pre></td></tr><tr><td data-num="2"></td><td><pre> 8048c59: <span class="token number">55</span>                    push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="3"></td><td><pre> 8048c5a: <span class="token number">89</span> e5                 mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre> 8048c5c: <span class="token number">83</span> ec <span class="token number">28</span>              sub    <span class="token operator">$</span><span class="token number">0x28</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="5"></td><td><pre> 8048c5f: c7 <span class="token number">45</span> f4 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="6"></td><td><pre> 8048c66: c7 <span class="token number">45</span> f0 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="7"></td><td><pre> 8048c6d: <span class="token number">8d</span> <span class="token number">45</span> e8              lea    <span class="token operator">-</span><span class="token number">0x18</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="8"></td><td><pre> 8048c70: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> 0c           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="9"></td><td><pre> 8048c74: <span class="token number">8d</span> <span class="token number">45</span> ec              lea    <span class="token operator">-</span><span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="10"></td><td><pre> 8048c77: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> <span class="token number">08</span>           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="11"></td><td><pre> 8048c7b: c7 <span class="token number">44</span> <span class="token number">24</span> <span class="token number">04</span> 7e a3 <span class="token number">04</span>  movl   <span class="token operator">$</span><span class="token number">0x804a37e</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="12"></td><td><pre> 8048c82: <span class="token number">08</span> </pre></td></tr><tr><td data-num="13"></td><td><pre> 8048c83: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="14"></td><td><pre> 8048c86: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="15"></td><td><pre> 8048c89: e8 <span class="token number">02</span> fc ff ff        call   <span class="token number">8048890</span> <span class="token operator">&lt;</span>__isoc99_sscanf@plt<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="16"></td><td><pre> 8048c8e: <span class="token number">89</span> <span class="token number">45</span> f0              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="17"></td><td><pre> 8048c91: <span class="token number">83</span> <span class="token number">7d</span> f0 <span class="token number">01</span>           cmpl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="18"></td><td><pre> 8048c95: 7f <span class="token number">05</span>                 jg     8048c9c <span class="token operator">&lt;</span>phase_3<span class="token operator">+</span><span class="token number">0x43</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="19"></td><td><pre> 8048c97: e8 <span class="token number">21</span> <span class="token number">07</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="20"></td><td><pre> 8048c9c: 8b <span class="token number">45</span> ec              mov    <span class="token operator">-</span><span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="21"></td><td><pre> 8048c9f: <span class="token number">83</span> f8 <span class="token number">07</span>              cmp    <span class="token operator">$</span><span class="token number">0x7</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="22"></td><td><pre> 8048ca2: <span class="token number">77</span> <span class="token number">51</span>                 ja     8048cf5 <span class="token operator">&lt;</span>phase_3<span class="token operator">+</span><span class="token number">0x9c</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="23"></td><td><pre> 8048ca4: 8b <span class="token number">04</span> <span class="token number">85</span> <span class="token number">84</span> a3 <span class="token number">04</span> <span class="token number">08</span>  mov    <span class="token number">0x804a384</span>(,<span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">4</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="24"></td><td><pre> 8048cab: ff e0                 jmp    <span class="token operator">*</span><span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="25"></td><td><pre> 8048cad: c7 <span class="token number">45</span> f4 <span class="token number">90</span> <span class="token number">03</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x390</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="26"></td><td><pre> 8048cb4: eb <span class="token number">44</span>                 jmp    8048cfa <span class="token operator">&lt;</span>phase_3<span class="token operator">+</span><span class="token number">0xa1</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="27"></td><td><pre> 8048cb6: c7 <span class="token number">45</span> f4 7e <span class="token number">02</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x27e</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="28"></td><td><pre> 8048cbd: eb 3b                 jmp    8048cfa <span class="token operator">&lt;</span>phase_3<span class="token operator">+</span><span class="token number">0xa1</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="29"></td><td><pre> 8048cbf: c7 <span class="token number">45</span> f4 eb <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x1eb</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="30"></td><td><pre> 8048cc6: eb <span class="token number">32</span>                 jmp    8048cfa <span class="token operator">&lt;</span>phase_3<span class="token operator">+</span><span class="token number">0xa1</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="31"></td><td><pre> 8048cc8: c7 <span class="token number">45</span> f4 9f <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x19f</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="32"></td><td><pre> 8048ccf: eb <span class="token number">29</span>                 jmp    8048cfa <span class="token operator">&lt;</span>phase_3<span class="token operator">+</span><span class="token number">0xa1</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="33"></td><td><pre> 8048cd1: c7 <span class="token number">45</span> f4 dc <span class="token number">02</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x2dc</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="34"></td><td><pre> 8048cd8: eb <span class="token number">20</span>                 jmp    8048cfa <span class="token operator">&lt;</span>phase_3<span class="token operator">+</span><span class="token number">0xa1</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="35"></td><td><pre> 8048cda: c7 <span class="token number">45</span> f4 d3 <span class="token number">03</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x3d3</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="36"></td><td><pre> 8048ce1: eb <span class="token number">17</span>                 jmp    8048cfa <span class="token operator">&lt;</span>phase_3<span class="token operator">+</span><span class="token number">0xa1</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="37"></td><td><pre> 8048ce3: c7 <span class="token number">45</span> f4 <span class="token number">78</span> <span class="token number">03</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x378</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="38"></td><td><pre> 8048cea: eb 0e                 jmp    8048cfa <span class="token operator">&lt;</span>phase_3<span class="token operator">+</span><span class="token number">0xa1</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="39"></td><td><pre> 8048cec: c7 <span class="token number">45</span> f4 <span class="token number">51</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x51</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="40"></td><td><pre> 8048cf3: eb <span class="token number">05</span>                 jmp    8048cfa <span class="token operator">&lt;</span>phase_3<span class="token operator">+</span><span class="token number">0xa1</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="41"></td><td><pre> 8048cf5: e8 c3 <span class="token number">06</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="42"></td><td><pre> 8048cfa: 8b <span class="token number">45</span> e8              mov    <span class="token operator">-</span><span class="token number">0x18</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="43"></td><td><pre> 8048cfd: <span class="token number">39</span> <span class="token number">45</span> f4              cmp    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="44"></td><td><pre> 8048d00: <span class="token number">74</span> <span class="token number">05</span>                 je     8048d07 <span class="token operator">&lt;</span>phase_3<span class="token operator">+</span><span class="token number">0xae</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="45"></td><td><pre> 8048d02: e8 b6 <span class="token number">06</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="46"></td><td><pre> 8048d07: c9                    leave</pre></td></tr><tr><td data-num="47"></td><td><pre> 8048d08: c3                    ret</pre></td></tr></tbody></table></figure><figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>(gdb) x <span class="token operator">/</span>s <span class="token number">0x804a37e</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">0x804a37e</span>:      <span class="token string">"%d %d"</span></pre></td></tr></tbody></table></figure><p>调用 <code>__isoc99_sscanf@plt</code>  函数，获得两个整数，若 <code>sscanf</code>  函数返回值 &lt;=1，无法从输入中获取两个整数，则调用 <code>explode_bomb</code>  函数，炸弹直接爆炸。<br>
接下来再检测第一个整数是否 &lt;=7，若不是，炸弹也直接爆炸。<br>
然后，再使用一个跳转表来根据第一个整数的值确定第二个整数所应该是的值。<br>
再比较输入的第二个整数与期望的值是否相等，如果不是，则调用 <code>explode_bomb</code>  函数，炸弹爆炸，反之函数正常返回。<br>
所以我们要做的就是查看 <code>0x804a384</code>  处的值，由于输入的第一个整数的范围在 <code>0&lt;=num1&lt;=7</code>  之间有 7 种可能。所以我们直接 <code>x /7wx 0x804a384</code>  即可获取相应跳转地址。</p>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>(gdb) x <span class="token operator">/</span>7wx <span class="token number">0x804a384</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">0x804a384</span>:      <span class="token number">0x08048cad</span>      <span class="token number">0x08048cb6</span>      <span class="token number">0x08048cbf</span>      <span class="token number">0x08048cc8</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token number">0x804a394</span>:      <span class="token number">0x08048cd1</span>      <span class="token number">0x08048cda</span>      <span class="token number">0x08048ce3</span></pre></td></tr></tbody></table></figure><p>得到跳转地址后，在根据反编译得到的汇编代码，获得每个第一个整数对应的第二个整数：</p>
<table>
<thead>
<tr>
<th style="text-align:center">num1</th>
<th style="text-align:center">num2_hex</th>
<th style="text-align:center">num2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">0x390</td>
<td style="text-align:center">912</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">0x27e</td>
<td style="text-align:center">638</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">0x1eb</td>
<td style="text-align:center">491</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">0x19f</td>
<td style="text-align:center">415</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">0x2dc</td>
<td style="text-align:center">732</td>
</tr>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">0x3d3</td>
<td style="text-align:center">979</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">0x378</td>
<td style="text-align:center">888</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">0x51</td>
<td style="text-align:center">81</td>
</tr>
</tbody>
</table>
<p>我们选择一组作为输入即可。</p>
<p><img loading="lazy" data-src="https://s2.loli.net/2023/05/13/EnYR8w3TvcHgoJS.png" alt=""></p>
<h1 id="phase_4"><a class="anchor" href="#phase_4">#</a> phase_4</h1>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>08048d60 <span class="token operator">&lt;</span>phase_4<span class="token operator">&gt;</span>:</pre></td></tr><tr><td data-num="2"></td><td><pre> 8048d60: <span class="token number">55</span>                    push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="3"></td><td><pre> 8048d61: <span class="token number">89</span> e5                 mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre> 8048d63: <span class="token number">83</span> ec <span class="token number">38</span>              sub    <span class="token operator">$</span><span class="token number">0x38</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="5"></td><td><pre> 8048d66: <span class="token number">8d</span> <span class="token number">45</span> e8              lea    <span class="token operator">-</span><span class="token number">0x18</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="6"></td><td><pre> 8048d69: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> 0c           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="7"></td><td><pre> 8048d6d: <span class="token number">8d</span> <span class="token number">45</span> e4              lea    <span class="token operator">-</span><span class="token number">0x1c</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="8"></td><td><pre> 8048d70: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> <span class="token number">08</span>           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="9"></td><td><pre> 8048d74: c7 <span class="token number">44</span> <span class="token number">24</span> <span class="token number">04</span> 7e a3 <span class="token number">04</span>  movl   <span class="token operator">$</span><span class="token number">0x804a37e</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="10"></td><td><pre> 8048d7b: <span class="token number">08</span> </pre></td></tr><tr><td data-num="11"></td><td><pre> 8048d7c: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="12"></td><td><pre> 8048d7f: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="13"></td><td><pre> 8048d82: e8 <span class="token number">09</span> fb ff ff        call   <span class="token number">8048890</span> <span class="token operator">&lt;</span>__isoc99_sscanf@plt<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="14"></td><td><pre> 8048d87: <span class="token number">89</span> <span class="token number">45</span> f4              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="15"></td><td><pre> 8048d8a: <span class="token number">83</span> <span class="token number">7d</span> f4 <span class="token number">02</span>           cmpl   <span class="token operator">$</span><span class="token number">0x2</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="16"></td><td><pre> 8048d8e: <span class="token number">75</span> <span class="token number">10</span>                 jne    8048da0 <span class="token operator">&lt;</span>phase_4<span class="token operator">+</span><span class="token number">0x40</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="17"></td><td><pre> 8048d90: 8b <span class="token number">45</span> e8              mov    <span class="token operator">-</span><span class="token number">0x18</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="18"></td><td><pre> 8048d93: <span class="token number">83</span> f8 <span class="token number">01</span>              cmp    <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="19"></td><td><pre> 8048d96: 7e <span class="token number">08</span>                 jle    8048da0 <span class="token operator">&lt;</span>phase_4<span class="token operator">+</span><span class="token number">0x40</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="20"></td><td><pre> 8048d98: 8b <span class="token number">45</span> e8              mov    <span class="token operator">-</span><span class="token number">0x18</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="21"></td><td><pre> 8048d9b: <span class="token number">83</span> f8 <span class="token number">04</span>              cmp    <span class="token operator">$</span><span class="token number">0x4</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="22"></td><td><pre> 8048d9e: 7e <span class="token number">05</span>                 jle    8048da5 <span class="token operator">&lt;</span>phase_4<span class="token operator">+</span><span class="token number">0x45</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="23"></td><td><pre> 8048da0: e8 <span class="token number">18</span> <span class="token number">06</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="24"></td><td><pre> 8048da5: c7 <span class="token number">45</span> f0 <span class="token number">07</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x7</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="25"></td><td><pre> 8048dac: 8b <span class="token number">45</span> e8              mov    <span class="token operator">-</span><span class="token number">0x18</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="26"></td><td><pre> 8048daf: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> <span class="token number">04</span>           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="27"></td><td><pre> 8048db3: 8b <span class="token number">45</span> f0              mov    <span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="28"></td><td><pre> 8048db6: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="29"></td><td><pre> 8048db9: e8 4b ff ff ff        call   8048d09 <span class="token operator">&lt;</span>func4<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="30"></td><td><pre> 8048dbe: <span class="token number">89</span> <span class="token number">45</span> ec              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="31"></td><td><pre> 8048dc1: 8b <span class="token number">45</span> e4              mov    <span class="token operator">-</span><span class="token number">0x1c</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="32"></td><td><pre> 8048dc4: <span class="token number">39</span> <span class="token number">45</span> ec              cmp    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="33"></td><td><pre> 8048dc7: <span class="token number">74</span> <span class="token number">05</span>                 je     8048dce <span class="token operator">&lt;</span>phase_4<span class="token operator">+</span><span class="token number">0x6e</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="34"></td><td><pre> 8048dc9: e8 ef <span class="token number">05</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="35"></td><td><pre> 8048dce: c9                    leave</pre></td></tr><tr><td data-num="36"></td><td><pre> 8048dcf: c3                    ret</pre></td></tr></tbody></table></figure><p>调用 <code>__isoc99_sscanf@plt</code>  函数，获得两个整数，若 <code>sscanf</code>  函数返回值不等于 2，则调用 <code>explode_bomb</code>  函数，炸弹直接爆炸。<br>
接下来再检测第一个整数是否满足 <code>1&lt;num1&lt;=4</code> ，若不是，炸弹也直接爆炸。<br>
然后，再调用 <code>func4</code>  函数，传入的参数分别是 7 和输入的第一个整数 <code>num1</code> ，将函数的返回值与输入的第二个整数进行比较。如果不相等，炸弹爆炸，反之函数正常返回。</p>
<p>所以我们接下来要做的就是去刨析 <code>func4</code>  函数的构造：</p>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>08048d09 <span class="token operator">&lt;</span>func4<span class="token operator">&gt;</span>:</pre></td></tr><tr><td data-num="2"></td><td><pre> 8048d09: <span class="token number">55</span>                    push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="3"></td><td><pre> 8048d0a: <span class="token number">89</span> e5                 mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre> 8048d0c: <span class="token number">53</span>                    push   <span class="token operator">%</span><span class="token register variable">ebx</span></pre></td></tr><tr><td data-num="5"></td><td><pre> 8048d0d: <span class="token number">83</span> ec <span class="token number">14</span>              sub    <span class="token operator">$</span><span class="token number">0x14</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="6"></td><td><pre> 8048d10: <span class="token number">83</span> <span class="token number">7d</span> <span class="token number">08</span> <span class="token number">00</span>           cmpl   <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="7"></td><td><pre> 8048d14: 7f <span class="token number">07</span>                 jg     8048d1d <span class="token operator">&lt;</span>func4<span class="token operator">+</span><span class="token number">0x14</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="8"></td><td><pre> 8048d16: b8 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>        mov    <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="9"></td><td><pre> 8048d1b: eb <span class="token number">3d</span>                 jmp    8048d5a <span class="token operator">&lt;</span>func4<span class="token operator">+</span><span class="token number">0x51</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="10"></td><td><pre> 8048d1d: <span class="token number">83</span> <span class="token number">7d</span> <span class="token number">08</span> <span class="token number">01</span>           cmpl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="11"></td><td><pre> 8048d21: <span class="token number">75</span> <span class="token number">05</span>                 jne    8048d28 <span class="token operator">&lt;</span>func4<span class="token operator">+</span><span class="token number">0x1f</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="12"></td><td><pre> 8048d23: 8b <span class="token number">45</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="13"></td><td><pre> 8048d26: eb <span class="token number">32</span>                 jmp    8048d5a <span class="token operator">&lt;</span>func4<span class="token operator">+</span><span class="token number">0x51</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="14"></td><td><pre> 8048d28: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="15"></td><td><pre> 8048d2b: <span class="token number">8d</span> <span class="token number">50</span> ff              lea    <span class="token operator">-</span><span class="token number">0x1</span>(<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="16"></td><td><pre> 8048d2e: 8b <span class="token number">45</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="17"></td><td><pre> 8048d31: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> <span class="token number">04</span>           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="18"></td><td><pre> 8048d35: <span class="token number">89</span> <span class="token number">14</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">edx</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="19"></td><td><pre> 8048d38: e8 cc ff ff ff        call   8048d09 <span class="token operator">&lt;</span>func4<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="20"></td><td><pre> 8048d3d: 8b <span class="token number">55</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="21"></td><td><pre> 8048d40: <span class="token number">8d</span> 1c <span class="token number">10</span>              lea    (<span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">%</span><span class="token register variable">edx</span>,<span class="token number">1</span>),<span class="token operator">%</span><span class="token register variable">ebx</span></pre></td></tr><tr><td data-num="22"></td><td><pre> 8048d43: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="23"></td><td><pre> 8048d46: <span class="token number">8d</span> <span class="token number">50</span> fe              lea    <span class="token operator">-</span><span class="token number">0x2</span>(<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="24"></td><td><pre> 8048d49: 8b <span class="token number">45</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="25"></td><td><pre> 8048d4c: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> <span class="token number">04</span>           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="26"></td><td><pre> 8048d50: <span class="token number">89</span> <span class="token number">14</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">edx</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="27"></td><td><pre> 8048d53: e8 b1 ff ff ff        call   8048d09 <span class="token operator">&lt;</span>func4<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="28"></td><td><pre> 8048d58: <span class="token number">01</span> d8                 add    <span class="token operator">%</span><span class="token register variable">ebx</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="29"></td><td><pre> 8048d5a: <span class="token number">83</span> c4 <span class="token number">14</span>              add    <span class="token operator">$</span><span class="token number">0x14</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="30"></td><td><pre> 8048d5d: 5b                    pop    <span class="token operator">%</span><span class="token register variable">ebx</span></pre></td></tr><tr><td data-num="31"></td><td><pre> 8048d5e: <span class="token number">5d</span>                    pop    <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="32"></td><td><pre> 8048d5f: c3                    ret</pre></td></tr></tbody></table></figure><p><code>func4</code>  是一个递归函数，其接受两个整数参数同时返回一个整数值。<br>
首先它会检查第一个参数是否为 0 或 1。如果是 0，则返回 0。如果是 1，则返回第二个参数的值。否则，它会将第一个参数减 1 并递归调用 <code>func4</code>  函数，将第一个参数减 2 并再次递归调用 <code>func4</code>  函数，再将两次递归调用的返回值与第二个参数 三个数相加作为当次函数的返回值返回。<br>
因此 <code>func4</code>  可以抽象为以下的式子：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>≤</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>y</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mn>1</mn><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><mi>y</mi><mo>+</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo>−</mo><mn>2</mn><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mi>x</mi><mo>&gt;</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex"> f(x,y)=\begin{cases}
    0 &amp; x \leq 0 \\
    y &amp; x = 1 \\
    f(x-1,y)+y+f(x-2,y) &amp; x &gt; 1
\end{cases} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"></path></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"></path></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>因为 <code>phase_4</code>  获取的第一个数值， <code>1&lt;num1&lt;=4</code> ，有三种可能，所以我们相对应有三种答案，在这里我们得到答案最方便的方法是编写一个程序模拟 <code>func4</code>  的过程来计算结果。</p>
<figure class="highlight cpp"><figcaption data-lang="C++"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"iostream"</span></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">int</span> <span class="token function">func4</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">if</span> <span class="token punctuation">(</span>x <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> y<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">return</span> y <span class="token operator">+</span> <span class="token function">func4</span><span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">func4</span><span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">}</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    std<span class="token double-colon punctuation">::</span>cout <span class="token operator">&lt;&lt;</span> <span class="token function">func4</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"\n"</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">}</span></pre></td></tr></tbody></table></figure><p>得到相应答案：</p>
<table>
<thead>
<tr>
<th style="text-align:center">x</th>
<th style="text-align:center">y</th>
<th style="text-align:center">result</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">2</td>
<td style="text-align:center">66</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">3</td>
<td style="text-align:center">99</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">4</td>
<td style="text-align:center">132</td>
</tr>
</tbody>
</table>
<p><img loading="lazy" data-src="https://s2.loli.net/2023/05/13/aocRXbwpmYJIgit.png" alt=""></p>
<h1 id="phase_5"><a class="anchor" href="#phase_5">#</a> phase_5</h1>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>08048dd0 <span class="token operator">&lt;</span>phase_5<span class="token operator">&gt;</span>:</pre></td></tr><tr><td data-num="2"></td><td><pre> 8048dd0: <span class="token number">55</span>                    push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="3"></td><td><pre> 8048dd1: <span class="token number">89</span> e5                 mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre> 8048dd3: <span class="token number">83</span> ec <span class="token number">28</span>              sub    <span class="token operator">$</span><span class="token number">0x28</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="5"></td><td><pre> 8048dd6: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="6"></td><td><pre> 8048dd9: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="7"></td><td><pre> 8048ddc: e8 <span class="token number">4d</span> <span class="token number">03</span> <span class="token number">00</span> <span class="token number">00</span>        call   804912e <span class="token operator">&lt;</span>string_length<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="8"></td><td><pre> 8048de1: <span class="token number">89</span> <span class="token number">45</span> f0              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="9"></td><td><pre> 8048de4: <span class="token number">83</span> <span class="token number">7d</span> f0 <span class="token number">06</span>           cmpl   <span class="token operator">$</span><span class="token number">0x6</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="10"></td><td><pre> 8048de8: <span class="token number">74</span> <span class="token number">05</span>                 je     8048def <span class="token operator">&lt;</span>phase_5<span class="token operator">+</span><span class="token number">0x1f</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="11"></td><td><pre> 8048dea: e8 ce <span class="token number">05</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="12"></td><td><pre> 8048def: c7 <span class="token number">45</span> f4 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="13"></td><td><pre> 8048df6: eb <span class="token number">26</span>                 jmp    8048e1e <span class="token operator">&lt;</span>phase_5<span class="token operator">+</span><span class="token number">0x4e</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="14"></td><td><pre> 8048df8: 8b <span class="token number">55</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="15"></td><td><pre> 8048dfb: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="16"></td><td><pre> 8048dfe: <span class="token number">01</span> d0                 add    <span class="token operator">%</span><span class="token register variable">edx</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="17"></td><td><pre> <span class="token number">8048e00</span>: 0f b6 <span class="token number">00</span>              movzbl (<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="18"></td><td><pre> <span class="token number">8048e03</span>: 0f be c0              movsbl <span class="token operator">%</span><span class="token register variable">al</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="19"></td><td><pre> <span class="token number">8048e06</span>: <span class="token number">83</span> e0 0f              and    <span class="token operator">$</span><span class="token number">0xf</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="20"></td><td><pre> <span class="token number">8048e09</span>: 0f b6 <span class="token number">80</span> a4 c1 <span class="token number">04</span> <span class="token number">08</span>  movzbl <span class="token number">0x804c1a4</span>(<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="21"></td><td><pre> <span class="token number">8048e10</span>: <span class="token number">8d</span> <span class="token number">4d</span> e9              lea    <span class="token operator">-</span><span class="token number">0x17</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">ecx</span></pre></td></tr><tr><td data-num="22"></td><td><pre> <span class="token number">8048e13</span>: 8b <span class="token number">55</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="23"></td><td><pre> <span class="token number">8048e16</span>: <span class="token number">01</span> ca                 add    <span class="token operator">%</span><span class="token register variable">ecx</span>,<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="24"></td><td><pre> <span class="token number">8048e18</span>: <span class="token number">88</span> <span class="token number">02</span>                 mov    <span class="token operator">%</span><span class="token register variable">al</span>,(<span class="token operator">%</span><span class="token register variable">edx</span>)</pre></td></tr><tr><td data-num="25"></td><td><pre> 8048e1a: <span class="token number">83</span> <span class="token number">45</span> f4 <span class="token number">01</span>           addl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="26"></td><td><pre> 8048e1e: <span class="token number">83</span> <span class="token number">7d</span> f4 <span class="token number">05</span>           cmpl   <span class="token operator">$</span><span class="token number">0x5</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="27"></td><td><pre> <span class="token number">8048e22</span>: 7e d4                 jle    8048df8 <span class="token operator">&lt;</span>phase_5<span class="token operator">+</span><span class="token number">0x28</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="28"></td><td><pre> <span class="token number">8048e24</span>: c6 <span class="token number">45</span> ef <span class="token number">00</span>           movb   <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token operator">-</span><span class="token number">0x11</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="29"></td><td><pre> <span class="token number">8048e28</span>: c7 <span class="token number">44</span> <span class="token number">24</span> <span class="token number">04</span> a4 a3 <span class="token number">04</span>  movl   <span class="token operator">$</span><span class="token number">0x804a3a4</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="30"></td><td><pre> 8048e2f: <span class="token number">08</span> </pre></td></tr><tr><td data-num="31"></td><td><pre> <span class="token number">8048e30</span>: <span class="token number">8d</span> <span class="token number">45</span> e9              lea    <span class="token operator">-</span><span class="token number">0x17</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="32"></td><td><pre> <span class="token number">8048e33</span>: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="33"></td><td><pre> <span class="token number">8048e36</span>: e8 1f <span class="token number">03</span> <span class="token number">00</span> <span class="token number">00</span>        call   804915a <span class="token operator">&lt;</span>strings_not_equal<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="34"></td><td><pre> 8048e3b: <span class="token number">85</span> c0                 test   <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="35"></td><td><pre> <span class="token number">8048e3d</span>: <span class="token number">74</span> <span class="token number">05</span>                 je     <span class="token number">8048e44</span> <span class="token operator">&lt;</span>phase_5<span class="token operator">+</span><span class="token number">0x74</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="36"></td><td><pre> 8048e3f: e8 <span class="token number">79</span> <span class="token number">05</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="37"></td><td><pre> <span class="token number">8048e44</span>: c9                    leave</pre></td></tr><tr><td data-num="38"></td><td><pre> <span class="token number">8048e45</span>: c3                    ret</pre></td></tr></tbody></table></figure><p>首先调用了 <code>string_length</code>  函数来获取输入字符串的长度。然后检查其长度是否等于 6，如果不是，则调用 <code>explode_bomb</code>  函数，炸弹爆炸。<br>
接下来进入到一个循环结构中，在每次迭代中都会处理字符串中的一个字符。对于这个字符，它首先将该字符转换它他的 <code>ascii</code>  码，然后将其与 <code>0xf</code>  进行按位与，然后，使用这个按位与后的结果作为索引在 <code>0x804c1a4</code>  处的一个长度为 16 的字符数组取到相应的字符。</p>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>(gdb) x <span class="token operator">/</span>s <span class="token number">0x804c1a4</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">0x804c1a4</span> <span class="token operator">&lt;</span>array<span class="token number">.2906</span><span class="token operator">&gt;</span>: <span class="token string">"maduiersnfotvbyl"</span></pre></td></tr></tbody></table></figure><p>最后调用 <code>strings_not_equal</code>  函数，来判断根据索引所取得的字符串是否等于地址 <code>0x804a3a4</code>  处的字符串。如果不是，则调用 <code>explode_bomb</code>  函数，炸弹爆炸，反之函数正常返回。</p>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>(gdb) x <span class="token operator">/</span>s <span class="token number">0x804a3a4</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">0x804a3a4</span>:      <span class="token string">"sabres"</span></pre></td></tr></tbody></table></figure><table>
<thead>
<tr>
<th style="text-align:center">m</th>
<th style="text-align:center">a</th>
<th style="text-align:center">d</th>
<th style="text-align:center">u</th>
<th style="text-align:center">i</th>
<th style="text-align:center">e</th>
<th style="text-align:center">r</th>
<th style="text-align:center">s</th>
<th style="text-align:center">n</th>
<th style="text-align:center">f</th>
<th style="text-align:center">o</th>
<th style="text-align:center">t</th>
<th style="text-align:center">v</th>
<th style="text-align:center">b</th>
<th style="text-align:center">y</th>
<th style="text-align:center">l</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0x0</td>
<td style="text-align:center">0x1</td>
<td style="text-align:center">0x2</td>
<td style="text-align:center">0x3</td>
<td style="text-align:center">0x4</td>
<td style="text-align:center">0x5</td>
<td style="text-align:center">0x6</td>
<td style="text-align:center">0x7</td>
<td style="text-align:center">0x8</td>
<td style="text-align:center">0x9</td>
<td style="text-align:center">0xa</td>
<td style="text-align:center">0xb</td>
<td style="text-align:center">0xc</td>
<td style="text-align:center">0xd</td>
<td style="text-align:center">0xe</td>
<td style="text-align:center">0xf</td>
</tr>
</tbody>
</table>
<p>所以我们便是要根据 <code>0x804c1a4</code>  处的索引数组，输入相应的 <code>ascii</code>  字符，是的索引后的结果字符串与 <code>0x804a3a4</code>  处字符串相等。</p>
<table>
<thead>
<tr>
<th style="text-align:center">s</th>
<th style="text-align:center">a</th>
<th style="text-align:center">b</th>
<th style="text-align:center">r</th>
<th style="text-align:center">e</th>
<th style="text-align:center">s</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0x7</td>
<td style="text-align:center">0x1</td>
<td style="text-align:center">0xd</td>
<td style="text-align:center">0x6</td>
<td style="text-align:center">0x5</td>
<td style="text-align:center">0x7</td>
</tr>
<tr>
<td style="text-align:center">7</td>
<td style="text-align:center">1</td>
<td style="text-align:center">-, =, M, m, ], }</td>
<td style="text-align:center">6</td>
<td style="text-align:center">5</td>
<td style="text-align:center">7</td>
</tr>
</tbody>
</table>
<p>所以我们的答案可以是 <code>71m657</code> 。</p>
<p><img loading="lazy" data-src="https://s2.loli.net/2023/05/13/YWymC29tiEbRU4h.png" alt=""></p>
<h1 id="phase_6"><a class="anchor" href="#phase_6">#</a> phase_6</h1>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre><span class="token number">08048e46</span> <span class="token operator">&lt;</span>phase_6<span class="token operator">&gt;</span>:</pre></td></tr><tr><td data-num="2"></td><td><pre> <span class="token number">8048e46</span>: <span class="token number">55</span>                    push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="3"></td><td><pre> <span class="token number">8048e47</span>: <span class="token number">89</span> e5                 mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre> <span class="token number">8048e49</span>: <span class="token number">83</span> ec <span class="token number">58</span>              sub    <span class="token operator">$</span><span class="token number">0x58</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="5"></td><td><pre> 8048e4c: c7 <span class="token number">45</span> e8 e4 c0 <span class="token number">04</span> <span class="token number">08</span>  movl   <span class="token operator">$</span><span class="token number">0x804c0e4</span>,<span class="token operator">-</span><span class="token number">0x18</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="6"></td><td><pre> <span class="token number">8048e53</span>: <span class="token number">8d</span> <span class="token number">45</span> d0              lea    <span class="token operator">-</span><span class="token number">0x30</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="7"></td><td><pre> <span class="token number">8048e56</span>: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> <span class="token number">04</span>           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="8"></td><td><pre> 8048e5a: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="9"></td><td><pre> <span class="token number">8048e5d</span>: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="10"></td><td><pre> <span class="token number">8048e60</span>: e8 <span class="token number">60</span> <span class="token number">02</span> <span class="token number">00</span> <span class="token number">00</span>        call   80490c5 <span class="token operator">&lt;</span>read_six_numbers<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="11"></td><td><pre> <span class="token number">8048e65</span>: c7 <span class="token number">45</span> f0 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="12"></td><td><pre> 8048e6c: eb 4c                 jmp    8048eba <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0x74</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="13"></td><td><pre> 8048e6e: 8b <span class="token number">45</span> f0              mov    <span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="14"></td><td><pre> <span class="token number">8048e71</span>: 8b <span class="token number">44</span> <span class="token number">85</span> d0           mov    <span class="token operator">-</span><span class="token number">0x30</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>,<span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">4</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="15"></td><td><pre> <span class="token number">8048e75</span>: <span class="token number">85</span> c0                 test   <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="16"></td><td><pre> <span class="token number">8048e77</span>: 7e 0c                 jle    <span class="token number">8048e85</span> <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0x3f</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="17"></td><td><pre> <span class="token number">8048e79</span>: 8b <span class="token number">45</span> f0              mov    <span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="18"></td><td><pre> 8048e7c: 8b <span class="token number">44</span> <span class="token number">85</span> d0           mov    <span class="token operator">-</span><span class="token number">0x30</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>,<span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">4</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="19"></td><td><pre> <span class="token number">8048e80</span>: <span class="token number">83</span> f8 <span class="token number">06</span>              cmp    <span class="token operator">$</span><span class="token number">0x6</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="20"></td><td><pre> <span class="token number">8048e83</span>: 7e <span class="token number">05</span>                 jle    8048e8a <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0x44</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="21"></td><td><pre> <span class="token number">8048e85</span>: e8 <span class="token number">33</span> <span class="token number">05</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="22"></td><td><pre> 8048e8a: 8b <span class="token number">45</span> f0              mov    <span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="23"></td><td><pre> <span class="token number">8048e8d</span>: <span class="token number">83</span> c0 <span class="token number">01</span>              add    <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="24"></td><td><pre> <span class="token number">8048e90</span>: <span class="token number">89</span> <span class="token number">45</span> ec              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="25"></td><td><pre> <span class="token number">8048e93</span>: eb <span class="token number">1b</span>                 jmp    8048eb0 <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0x6a</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="26"></td><td><pre> <span class="token number">8048e95</span>: 8b <span class="token number">45</span> f0              mov    <span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="27"></td><td><pre> <span class="token number">8048e98</span>: 8b <span class="token number">54</span> <span class="token number">85</span> d0           mov    <span class="token operator">-</span><span class="token number">0x30</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>,<span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">4</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="28"></td><td><pre> 8048e9c: 8b <span class="token number">45</span> ec              mov    <span class="token operator">-</span><span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="29"></td><td><pre> 8048e9f: 8b <span class="token number">44</span> <span class="token number">85</span> d0           mov    <span class="token operator">-</span><span class="token number">0x30</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>,<span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">4</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="30"></td><td><pre> 8048ea3: <span class="token number">39</span> c2                 cmp    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="31"></td><td><pre> 8048ea5: <span class="token number">75</span> <span class="token number">05</span>                 jne    8048eac <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0x66</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="32"></td><td><pre> 8048ea7: e8 <span class="token number">11</span> <span class="token number">05</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="33"></td><td><pre> 8048eac: <span class="token number">83</span> <span class="token number">45</span> ec <span class="token number">01</span>           addl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="34"></td><td><pre> 8048eb0: <span class="token number">83</span> <span class="token number">7d</span> ec <span class="token number">05</span>           cmpl   <span class="token operator">$</span><span class="token number">0x5</span>,<span class="token operator">-</span><span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="35"></td><td><pre> 8048eb4: 7e df                 jle    <span class="token number">8048e95</span> <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0x4f</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="36"></td><td><pre> 8048eb6: <span class="token number">83</span> <span class="token number">45</span> f0 <span class="token number">01</span>           addl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="37"></td><td><pre> 8048eba: <span class="token number">83</span> <span class="token number">7d</span> f0 <span class="token number">05</span>           cmpl   <span class="token operator">$</span><span class="token number">0x5</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="38"></td><td><pre> 8048ebe: 7e ae                 jle    8048e6e <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0x28</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="39"></td><td><pre> 8048ec0: c7 <span class="token number">45</span> f0 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="40"></td><td><pre> 8048ec7: eb <span class="token number">36</span>                 jmp    8048eff <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0xb9</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="41"></td><td><pre> 8048ec9: 8b <span class="token number">45</span> e8              mov    <span class="token operator">-</span><span class="token number">0x18</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="42"></td><td><pre> 8048ecc: <span class="token number">89</span> <span class="token number">45</span> f4              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="43"></td><td><pre> 8048ecf: c7 <span class="token number">45</span> ec <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="44"></td><td><pre> 8048ed6: eb <span class="token number">0d</span>                 jmp    8048ee5 <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0x9f</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="45"></td><td><pre> 8048ed8: 8b <span class="token number">45</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="46"></td><td><pre> 8048edb: 8b <span class="token number">40</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="47"></td><td><pre> 8048ede: <span class="token number">89</span> <span class="token number">45</span> f4              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="48"></td><td><pre> 8048ee1: <span class="token number">83</span> <span class="token number">45</span> ec <span class="token number">01</span>           addl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="49"></td><td><pre> 8048ee5: 8b <span class="token number">45</span> f0              mov    <span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="50"></td><td><pre> 8048ee8: 8b <span class="token number">44</span> <span class="token number">85</span> d0           mov    <span class="token operator">-</span><span class="token number">0x30</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>,<span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">4</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="51"></td><td><pre> 8048eec: 3b <span class="token number">45</span> ec              cmp    <span class="token operator">-</span><span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="52"></td><td><pre> 8048eef: 7f e7                 jg     8048ed8 <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0x92</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="53"></td><td><pre> 8048ef1: 8b <span class="token number">45</span> f0              mov    <span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="54"></td><td><pre> 8048ef4: 8b <span class="token number">55</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="55"></td><td><pre> 8048ef7: <span class="token number">89</span> <span class="token number">54</span> <span class="token number">85</span> b8           mov    <span class="token operator">%</span><span class="token register variable">edx</span>,<span class="token operator">-</span><span class="token number">0x48</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>,<span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">4</span>)</pre></td></tr><tr><td data-num="56"></td><td><pre> 8048efb: <span class="token number">83</span> <span class="token number">45</span> f0 <span class="token number">01</span>           addl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="57"></td><td><pre> 8048eff: <span class="token number">83</span> <span class="token number">7d</span> f0 <span class="token number">05</span>           cmpl   <span class="token operator">$</span><span class="token number">0x5</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="58"></td><td><pre> 8048f03: 7e c4                 jle    8048ec9 <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0x83</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="59"></td><td><pre> 8048f05: 8b <span class="token number">45</span> b8              mov    <span class="token operator">-</span><span class="token number">0x48</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="60"></td><td><pre> 8048f08: <span class="token number">89</span> <span class="token number">45</span> e8              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0x18</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="61"></td><td><pre> 8048f0b: 8b <span class="token number">45</span> e8              mov    <span class="token operator">-</span><span class="token number">0x18</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="62"></td><td><pre> 8048f0e: <span class="token number">89</span> <span class="token number">45</span> f4              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="63"></td><td><pre> 8048f11: c7 <span class="token number">45</span> f0 <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="64"></td><td><pre> 8048f18: eb 1a                 jmp    8048f34 <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0xee</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="65"></td><td><pre> 8048f1a: 8b <span class="token number">45</span> f0              mov    <span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="66"></td><td><pre> 8048f1d: 8b <span class="token number">54</span> <span class="token number">85</span> b8           mov    <span class="token operator">-</span><span class="token number">0x48</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>,<span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">4</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="67"></td><td><pre> 8048f21: 8b <span class="token number">45</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="68"></td><td><pre> 8048f24: <span class="token number">89</span> <span class="token number">50</span> <span class="token number">08</span>              mov    <span class="token operator">%</span><span class="token register variable">edx</span>,<span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">eax</span>)</pre></td></tr><tr><td data-num="69"></td><td><pre> 8048f27: 8b <span class="token number">45</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="70"></td><td><pre> 8048f2a: 8b <span class="token number">40</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="71"></td><td><pre> 8048f2d: <span class="token number">89</span> <span class="token number">45</span> f4              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="72"></td><td><pre> 8048f30: <span class="token number">83</span> <span class="token number">45</span> f0 <span class="token number">01</span>           addl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="73"></td><td><pre> 8048f34: <span class="token number">83</span> <span class="token number">7d</span> f0 <span class="token number">05</span>           cmpl   <span class="token operator">$</span><span class="token number">0x5</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="74"></td><td><pre> 8048f38: 7e e0                 jle    8048f1a <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0xd4</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="75"></td><td><pre> 8048f3a: 8b <span class="token number">45</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="76"></td><td><pre> 8048f3d: c7 <span class="token number">40</span> <span class="token number">08</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">eax</span>)</pre></td></tr><tr><td data-num="77"></td><td><pre> 8048f44: 8b <span class="token number">45</span> e8              mov    <span class="token operator">-</span><span class="token number">0x18</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="78"></td><td><pre> 8048f47: <span class="token number">89</span> <span class="token number">45</span> f4              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="79"></td><td><pre> 8048f4a: c7 <span class="token number">45</span> f0 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="80"></td><td><pre> 8048f51: eb <span class="token number">23</span>                 jmp    8048f76 <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0x130</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="81"></td><td><pre> 8048f53: 8b <span class="token number">45</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="82"></td><td><pre> 8048f56: 8b <span class="token number">10</span>                 mov    (<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="83"></td><td><pre> 8048f58: 8b <span class="token number">45</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="84"></td><td><pre> 8048f5b: 8b <span class="token number">40</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="85"></td><td><pre> 8048f5e: 8b <span class="token number">00</span>                 mov    (<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="86"></td><td><pre> 8048f60: <span class="token number">39</span> c2                 cmp    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="87"></td><td><pre> 8048f62: <span class="token number">7d</span> <span class="token number">05</span>                 jge    8048f69 <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0x123</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="88"></td><td><pre> 8048f64: e8 <span class="token number">54</span> <span class="token number">04</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="89"></td><td><pre> 8048f69: 8b <span class="token number">45</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="90"></td><td><pre> 8048f6c: 8b <span class="token number">40</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="91"></td><td><pre> 8048f6f: <span class="token number">89</span> <span class="token number">45</span> f4              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="92"></td><td><pre> 8048f72: <span class="token number">83</span> <span class="token number">45</span> f0 <span class="token number">01</span>           addl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="93"></td><td><pre> 8048f76: <span class="token number">83</span> <span class="token number">7d</span> f0 <span class="token number">04</span>           cmpl   <span class="token operator">$</span><span class="token number">0x4</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="94"></td><td><pre> 8048f7a: 7e d7                 jle    8048f53 <span class="token operator">&lt;</span>phase_6<span class="token operator">+</span><span class="token number">0x10d</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="95"></td><td><pre> 8048f7c: c9                    leave</pre></td></tr><tr><td data-num="96"></td><td><pre> 8048f7d: c3                    ret</pre></td></tr></tbody></table></figure><p>先调用 <code>read_six_numbers</code> ，获取六个整数，判断输入的这六个数是否有相等的，如果有，则调用 <code>explode_bomb</code>  函数，炸弹爆炸。<br>
获取完 6 个数后，从 <code>ebp-18 (0x804c0e4)</code>  中取一个偏移为 4 的值我们可以发现，取得值也是一个地址，再依次将其取出，结果如下：</p>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>(gdb) x <span class="token operator">/</span>3wx <span class="token number">0x0804c0e4</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">0x804c0e4</span> <span class="token operator">&lt;</span>node1<span class="token operator">&gt;</span>:      <span class="token number">0x0000017f</span>      <span class="token number">0x00000001</span>      <span class="token number">0x0804c0d8</span></pre></td></tr><tr><td data-num="3"></td><td><pre>(gdb) x <span class="token operator">/</span>3wx <span class="token number">0x0804c0d8</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token number">0x804c0d8</span> <span class="token operator">&lt;</span>node2<span class="token operator">&gt;</span>:      <span class="token number">0x00000202</span>      <span class="token number">0x00000002</span>      <span class="token number">0x0804c0cc</span></pre></td></tr><tr><td data-num="5"></td><td><pre>(gdb) x <span class="token operator">/</span>3wx <span class="token number">0x0804c0cc</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token number">0x804c0cc</span> <span class="token operator">&lt;</span>node3<span class="token operator">&gt;</span>:      <span class="token number">0x000000b3</span>      <span class="token number">0x00000003</span>      <span class="token number">0x0804c0c0</span></pre></td></tr><tr><td data-num="7"></td><td><pre>(gdb) x <span class="token operator">/</span>3wx <span class="token number">0x0804c0c0</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token number">0x804c0c0</span> <span class="token operator">&lt;</span>node4<span class="token operator">&gt;</span>:      <span class="token number">0x0000012e</span>      <span class="token number">0x00000004</span>      <span class="token number">0x0804c0b4</span></pre></td></tr><tr><td data-num="9"></td><td><pre>(gdb) x <span class="token operator">/</span>3wx <span class="token number">0x0804c0b4</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token number">0x804c0b4</span> <span class="token operator">&lt;</span>node5<span class="token operator">&gt;</span>:      <span class="token number">0x0000035d</span>      <span class="token number">0x00000005</span>      <span class="token number">0x0804c0a8</span></pre></td></tr><tr><td data-num="11"></td><td><pre>(gdb) x <span class="token operator">/</span>3wx <span class="token number">0x0804c0a8</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token number">0x804c0a8</span> <span class="token operator">&lt;</span>node6<span class="token operator">&gt;</span>:      <span class="token number">0x00000171</span>      <span class="token number">0x00000006</span>      <span class="token number">0x00000000</span></pre></td></tr></tbody></table></figure><p>不难发现，从 <code>0x804c0e4</code>  开始的正是一个链表，该链表结构中主要有三个元素：<br>
1、 当前节点的值；2、当前节点再列表中的顺序；3、当前节点的下一个节点。</p>
<table>
<thead>
<tr>
<th style="text-align:center">node_add</th>
<th style="text-align:center">value_hex</th>
<th style="text-align:center">value</th>
<th style="text-align:center">order</th>
<th style="text-align:center">next_node_add</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0x804c0e4</td>
<td style="text-align:center">0x0000017f</td>
<td style="text-align:center">383</td>
<td style="text-align:center">0x00000001</td>
<td style="text-align:center">0x0804c0d8</td>
</tr>
<tr>
<td style="text-align:center">0x804c0d8</td>
<td style="text-align:center">0x00000202</td>
<td style="text-align:center">514</td>
<td style="text-align:center">0x00000002</td>
<td style="text-align:center">0x0804c0cc</td>
</tr>
<tr>
<td style="text-align:center">0x0804c0cc</td>
<td style="text-align:center">0x000000b3</td>
<td style="text-align:center">179</td>
<td style="text-align:center">0x00000003</td>
<td style="text-align:center">0x0804c0c0</td>
</tr>
<tr>
<td style="text-align:center">0x0804c0c0</td>
<td style="text-align:center">0x0000012e</td>
<td style="text-align:center">302</td>
<td style="text-align:center">0x00000004</td>
<td style="text-align:center">0x0804c0b4</td>
</tr>
<tr>
<td style="text-align:center">0x0804c0b4</td>
<td style="text-align:center">0x0000035d</td>
<td style="text-align:center">861</td>
<td style="text-align:center">0x00000005</td>
<td style="text-align:center">0x0804c0a8</td>
</tr>
<tr>
<td style="text-align:center">0x0804c0a8</td>
<td style="text-align:center">0x00000171</td>
<td style="text-align:center">369</td>
<td style="text-align:center">0x00000006</td>
<td style="text-align:center">0x00000000</td>
</tr>
</tbody>
</table>
<p>再回到汇编中，我们可以发现，它将输入的值作为顺序 <code>order</code> ，将原本的链表进行了非原地排序。<br>
接着再分析之后的一个循环结构，可以发先它是在校验我们排序后的链表是否满足非递增的顺序。</p>
<p>因此我们要做的就是针对取出来的数，进行递减的排序，然后对于排序后的元素，取其中的 <code>order</code>  作为输入即可满足要求。</p>
<p>383,514,179,302,861,369  <code>--&gt;</code>  861,514,383,369,302,179  <code>--&gt;</code>  5 2 1 6 4 3<br>
 得到答案 5 2 1 6 4 3</p>
<p><img loading="lazy" data-src="https://s2.loli.net/2023/05/13/9cyUuALTRYsvFx1.png" alt=""></p>
<h1 id="phase_defused"><a class="anchor" href="#phase_defused">#</a> phase_defused</h1>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre><span class="token number">080493e7</span> <span class="token operator">&lt;</span>phase_defused<span class="token operator">&gt;</span>:</pre></td></tr><tr><td data-num="2"></td><td><pre> <span class="token number">80493e7</span>: <span class="token number">55</span>                    push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="3"></td><td><pre> <span class="token number">80493e8</span>: <span class="token number">89</span> e5                 mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre> 80493ea: <span class="token number">81</span> ec <span class="token number">88</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>     sub    <span class="token operator">$</span><span class="token number">0x88</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="5"></td><td><pre> 80493f0: a1 e8 c3 <span class="token number">04</span> <span class="token number">08</span>        mov    <span class="token number">0x804c3e8</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="6"></td><td><pre> 80493f5: <span class="token number">83</span> f8 <span class="token number">06</span>              cmp    <span class="token operator">$</span><span class="token number">0x6</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="7"></td><td><pre> 80493f8: <span class="token number">75</span> <span class="token number">72</span>                 jne    804946c <span class="token operator">&lt;</span>phase_defused<span class="token operator">+</span><span class="token number">0x85</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="8"></td><td><pre> 80493fa: <span class="token number">8d</span> <span class="token number">45</span> a4              lea    <span class="token operator">-</span><span class="token number">0x5c</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="9"></td><td><pre> 80493fd: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> <span class="token number">10</span>           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="10"></td><td><pre> <span class="token number">8049401</span>: <span class="token number">8d</span> <span class="token number">45</span> 9c              lea    <span class="token operator">-</span><span class="token number">0x64</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="11"></td><td><pre> <span class="token number">8049404</span>: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> 0c           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="12"></td><td><pre> <span class="token number">8049408</span>: <span class="token number">8d</span> <span class="token number">45</span> a0              lea    <span class="token operator">-</span><span class="token number">0x60</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="13"></td><td><pre> 804940b: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> <span class="token number">08</span>           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="14"></td><td><pre> 804940f: c7 <span class="token number">44</span> <span class="token number">24</span> <span class="token number">04</span> f3 a4 <span class="token number">04</span>  movl   <span class="token operator">$</span><span class="token number">0x804a4f3</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="15"></td><td><pre> <span class="token number">8049416</span>: <span class="token number">08</span> </pre></td></tr><tr><td data-num="16"></td><td><pre> <span class="token number">8049417</span>: c7 <span class="token number">04</span> <span class="token number">24</span> f0 c4 <span class="token number">04</span> <span class="token number">08</span>  movl   <span class="token operator">$</span><span class="token number">0x804c4f0</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="17"></td><td><pre> 804941e: e8 <span class="token number">6d</span> f4 ff ff        call   <span class="token number">8048890</span> <span class="token operator">&lt;</span>__isoc99_sscanf@plt<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="18"></td><td><pre> <span class="token number">8049423</span>: <span class="token number">89</span> <span class="token number">45</span> f4              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="19"></td><td><pre> <span class="token number">8049426</span>: <span class="token number">83</span> <span class="token number">7d</span> f4 <span class="token number">03</span>           cmpl   <span class="token operator">$</span><span class="token number">0x3</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="20"></td><td><pre> 804942a: <span class="token number">75</span> <span class="token number">34</span>                 jne    <span class="token number">8049460</span> <span class="token operator">&lt;</span>phase_defused<span class="token operator">+</span><span class="token number">0x79</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="21"></td><td><pre> 804942c: c7 <span class="token number">44</span> <span class="token number">24</span> <span class="token number">04</span> fc a4 <span class="token number">04</span>  movl   <span class="token operator">$</span><span class="token number">0x804a4fc</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="22"></td><td><pre> <span class="token number">8049433</span>: <span class="token number">08</span> </pre></td></tr><tr><td data-num="23"></td><td><pre> <span class="token number">8049434</span>: <span class="token number">8d</span> <span class="token number">45</span> a4              lea    <span class="token operator">-</span><span class="token number">0x5c</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="24"></td><td><pre> <span class="token number">8049437</span>: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="25"></td><td><pre> 804943a: e8 <span class="token number">1b</span> fd ff ff        call   804915a <span class="token operator">&lt;</span>strings_not_equal<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="26"></td><td><pre> 804943f: <span class="token number">85</span> c0                 test   <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="27"></td><td><pre> <span class="token number">8049441</span>: <span class="token number">75</span> <span class="token number">1d</span>                 jne    <span class="token number">8049460</span> <span class="token operator">&lt;</span>phase_defused<span class="token operator">+</span><span class="token number">0x79</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="28"></td><td><pre> <span class="token number">8049443</span>: c7 <span class="token number">04</span> <span class="token number">24</span> <span class="token number">04</span> a5 <span class="token number">04</span> <span class="token number">08</span>  movl   <span class="token operator">$</span><span class="token number">0x804a504</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="29"></td><td><pre> 804944a: e8 e1 f3 ff ff        call   <span class="token number">8048830</span> <span class="token operator">&lt;</span>puts@plt<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="30"></td><td><pre> 804944f: c7 <span class="token number">04</span> <span class="token number">24</span> 2c a5 <span class="token number">04</span> <span class="token number">08</span>  movl   <span class="token operator">$</span><span class="token number">0x804a52c</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="31"></td><td><pre> <span class="token number">8049456</span>: e8 d5 f3 ff ff        call   <span class="token number">8048830</span> <span class="token operator">&lt;</span>puts@plt<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="32"></td><td><pre> 804945b: e8 <span class="token number">81</span> fb ff ff        call   8048fe1 <span class="token operator">&lt;</span>secret_phase<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="33"></td><td><pre> <span class="token number">8049460</span>: c7 <span class="token number">04</span> <span class="token number">24</span> <span class="token number">64</span> a5 <span class="token number">04</span> <span class="token number">08</span>  movl   <span class="token operator">$</span><span class="token number">0x804a564</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="34"></td><td><pre> <span class="token number">8049467</span>: e8 c4 f3 ff ff        call   <span class="token number">8048830</span> <span class="token operator">&lt;</span>puts@plt<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="35"></td><td><pre> 804946c: c9                    leave</pre></td></tr><tr><td data-num="36"></td><td><pre> <span class="token number">804946d</span>: c3                    ret</pre></td></tr></tbody></table></figure><p>最后的最后就是隐藏关卡 <code>secret_phase</code> ，但我们首先要找到进入 <code>secret_phase</code>  的方法。<br>
不难发现，汇编代码中，只有在 <code>phase_defused</code>  调用了 <code>secret_phase</code> 。<br>
分析汇编代码，可以发现主要是在 <code>sscanf</code>  时，从 <code>0x804c4f0</code>  的字符串中按照 <code>0x804a4f3</code>  的格式读取数值，如果返回值为 3，同时输入的字符串与 <code>0x804a4fc</code>  的字符串相等，则进入 <code>secret_phase</code> 。</p>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>(gdb) x <span class="token operator">/</span>s <span class="token number">0x804c4f0</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">0x804c4f0</span> <span class="token operator">&lt;</span>input_strings<span class="token operator">+</span><span class="token number">240</span><span class="token operator">&gt;</span>:  <span class="token string">""</span></pre></td></tr><tr><td data-num="3"></td><td><pre>(gdb) x <span class="token operator">/</span>s <span class="token number">0x804a4f3</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token number">0x804a4f3</span>:      <span class="token string">"%d %d %s"</span></pre></td></tr><tr><td data-num="5"></td><td><pre>(gdb) x <span class="token operator">/</span>s <span class="token number">0x804a4fc</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token number">0x804a4fc</span>:      <span class="token string">"DrEvil"</span></pre></td></tr></tbody></table></figure><p>而形如 <code>"%d %d %s"</code>  的输入我们只在关卡 3 与关卡 4 中输入过，所以我们主要要找到 <code>0x804c4f0</code>  处对应的输入，我尝试在 3、4 中皆输入 <code>DrEvil</code> 。</p>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>(gdb) x <span class="token operator">/</span>256s <span class="token number">0x804c400</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">0x804c400</span> <span class="token operator">&lt;</span>input_strings<span class="token operator">&gt;</span>:      <span class="token string">"I am the mayor. I can do anything I want."</span></pre></td></tr><tr><td data-num="3"></td><td><pre>...</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token number">0x804c450</span> <span class="token operator">&lt;</span>input_strings<span class="token operator">+</span><span class="token number">80</span><span class="token operator">&gt;</span>:   <span class="token string">"0 1 1 2 3 5"</span></pre></td></tr><tr><td data-num="5"></td><td><pre>...</pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token number">0x804c4a0</span> <span class="token operator">&lt;</span>input_strings<span class="token operator">+</span><span class="token number">160</span><span class="token operator">&gt;</span>:  <span class="token string">"6 888 DrEvil"</span></pre></td></tr><tr><td data-num="7"></td><td><pre>...</pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token number">0x804c4f0</span> <span class="token operator">&lt;</span>input_strings<span class="token operator">+</span><span class="token number">240</span><span class="token operator">&gt;</span>:  <span class="token string">"66 2 DrEvil"</span></pre></td></tr></tbody></table></figure><p>可以发现， <code>0x804c4f0</code>  对应的是第四关的输入。<br>
因此我们只需要在第四关的答案中添加 <code>DrEvil</code>  即可进入 <code>secret_phase</code> 。</p>
<h1 id="secret_phase"><a class="anchor" href="#secret_phase">#</a> secret_phase</h1>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>08048fe1 <span class="token operator">&lt;</span>secret_phase<span class="token operator">&gt;</span>:</pre></td></tr><tr><td data-num="2"></td><td><pre> 8048fe1: <span class="token number">55</span>                    push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="3"></td><td><pre> 8048fe2: <span class="token number">89</span> e5                 mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre> 8048fe4: <span class="token number">83</span> ec <span class="token number">28</span>              sub    <span class="token operator">$</span><span class="token number">0x28</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="5"></td><td><pre> 8048fe7: e8 9a <span class="token number">02</span> <span class="token number">00</span> <span class="token number">00</span>        call   <span class="token number">8049286</span> <span class="token operator">&lt;</span>read_line<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="6"></td><td><pre> 8048fec: <span class="token number">89</span> <span class="token number">45</span> f4              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="7"></td><td><pre> 8048fef: 8b <span class="token number">45</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="8"></td><td><pre> 8048ff2: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="9"></td><td><pre> 8048ff5: e8 d6 f8 ff ff        call   80488d0 <span class="token operator">&lt;</span>atoi@plt<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="10"></td><td><pre> 8048ffa: <span class="token number">89</span> <span class="token number">45</span> f0              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="11"></td><td><pre> 8048ffd: <span class="token number">83</span> <span class="token number">7d</span> f0 <span class="token number">00</span>           cmpl   <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="12"></td><td><pre> <span class="token number">8049001</span>: 7e <span class="token number">09</span>                 jle    804900c <span class="token operator">&lt;</span>secret_phase<span class="token operator">+</span><span class="token number">0x2b</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="13"></td><td><pre> <span class="token number">8049003</span>: <span class="token number">81</span> <span class="token number">7d</span> f0 e9 <span class="token number">03</span> <span class="token number">00</span> <span class="token number">00</span>  cmpl   <span class="token operator">$</span><span class="token number">0x3e9</span>,<span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="14"></td><td><pre> 804900a: 7e <span class="token number">05</span>                 jle    <span class="token number">8049011</span> <span class="token operator">&lt;</span>secret_phase<span class="token operator">+</span><span class="token number">0x30</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="15"></td><td><pre> 804900c: e8 ac <span class="token number">03</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="16"></td><td><pre> <span class="token number">8049011</span>: 8b <span class="token number">45</span> f0              mov    <span class="token operator">-</span><span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="17"></td><td><pre> <span class="token number">8049014</span>: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> <span class="token number">04</span>           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="18"></td><td><pre> <span class="token number">8049018</span>: c7 <span class="token number">04</span> <span class="token number">24</span> <span class="token number">98</span> c1 <span class="token number">04</span> <span class="token number">08</span>  movl   <span class="token operator">$</span><span class="token number">0x804c198</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="19"></td><td><pre> 804901f: e8 5a ff ff ff        call   8048f7e <span class="token operator">&lt;</span>fun7<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="20"></td><td><pre> <span class="token number">8049024</span>: <span class="token number">89</span> <span class="token number">45</span> ec              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="21"></td><td><pre> <span class="token number">8049027</span>: <span class="token number">83</span> <span class="token number">7d</span> ec <span class="token number">07</span>           cmpl   <span class="token operator">$</span><span class="token number">0x7</span>,<span class="token operator">-</span><span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="22"></td><td><pre> 804902b: <span class="token number">74</span> <span class="token number">05</span>                 je     <span class="token number">8049032</span> <span class="token operator">&lt;</span>secret_phase<span class="token operator">+</span><span class="token number">0x51</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="23"></td><td><pre> <span class="token number">804902d</span>: e8 8b <span class="token number">03</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="24"></td><td><pre> <span class="token number">8049032</span>: c7 <span class="token number">04</span> <span class="token number">24</span> ac a3 <span class="token number">04</span> <span class="token number">08</span>  movl   <span class="token operator">$</span><span class="token number">0x804a3ac</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="25"></td><td><pre> <span class="token number">8049039</span>: e8 f2 f7 ff ff        call   <span class="token number">8048830</span> <span class="token operator">&lt;</span>puts@plt<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="26"></td><td><pre> 804903e: e8 a4 <span class="token number">03</span> <span class="token number">00</span> <span class="token number">00</span>        call   <span class="token number">80493e7</span> <span class="token operator">&lt;</span>phase_defused<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="27"></td><td><pre> <span class="token number">8049043</span>: c9                    leave</pre></td></tr><tr><td data-num="28"></td><td><pre> <span class="token number">8049044</span>: c3                    ret</pre></td></tr></tbody></table></figure><p>在该函数中，它先调用 <code>read_line</code>  函数获取一行输入。调用 <code>atoi@plt</code>  函数，将读取的一行输入转换为整数。然后检查该整数是否满足 <code>0&lt;x&lt;=1001</code> ，如果不是，则调用 <code>explode_bomb</code>  函数，炸弹爆炸。<br>
接下来，调用 <code>fun7</code>  函数，将地址 <code>0x804c198</code>  作为第一个参数，输入的整数作为第二个参数，将 <code>fun7</code>  函数的返回值与 7 进行比较。如果不相等，则炸弹爆炸。反之，成功拆除炸弹。</p>
<p>所以我们要做的就是和关卡 4 类似，将重心转移至 <code>fun7</code>  中，刨析 <code>fun7</code>  的构造：</p>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>08048f7e <span class="token operator">&lt;</span>fun7<span class="token operator">&gt;</span>:</pre></td></tr><tr><td data-num="2"></td><td><pre> 8048f7e: <span class="token number">55</span>                    push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="3"></td><td><pre> 8048f7f: <span class="token number">89</span> e5                 mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre> 8048f81: <span class="token number">83</span> ec <span class="token number">18</span>              sub    <span class="token operator">$</span><span class="token number">0x18</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="5"></td><td><pre> 8048f84: <span class="token number">83</span> <span class="token number">7d</span> <span class="token number">08</span> <span class="token number">00</span>           cmpl   <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="6"></td><td><pre> 8048f88: <span class="token number">75</span> <span class="token number">07</span>                 jne    8048f91 <span class="token operator">&lt;</span>fun7<span class="token operator">+</span><span class="token number">0x13</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="7"></td><td><pre> 8048f8a: b8 ff ff ff ff        mov    <span class="token operator">$</span><span class="token number">0xffffffff</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="8"></td><td><pre> 8048f8f: eb 4e                 jmp    8048fdf <span class="token operator">&lt;</span>fun7<span class="token operator">+</span><span class="token number">0x61</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="9"></td><td><pre> 8048f91: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="10"></td><td><pre> 8048f94: 8b <span class="token number">00</span>                 mov    (<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="11"></td><td><pre> 8048f96: 3b <span class="token number">45</span> 0c              cmp    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="12"></td><td><pre> 8048f99: 7e <span class="token number">19</span>                 jle    8048fb4 <span class="token operator">&lt;</span>fun7<span class="token operator">+</span><span class="token number">0x36</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="13"></td><td><pre> 8048f9b: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="14"></td><td><pre> 8048f9e: 8b <span class="token number">40</span> <span class="token number">04</span>              mov    <span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="15"></td><td><pre> 8048fa1: 8b <span class="token number">55</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="16"></td><td><pre> 8048fa4: <span class="token number">89</span> <span class="token number">54</span> <span class="token number">24</span> <span class="token number">04</span>           mov    <span class="token operator">%</span><span class="token register variable">edx</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="17"></td><td><pre> 8048fa8: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="18"></td><td><pre> 8048fab: e8 ce ff ff ff        call   8048f7e <span class="token operator">&lt;</span>fun7<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="19"></td><td><pre> 8048fb0: <span class="token number">01</span> c0                 add    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="20"></td><td><pre> 8048fb2: eb 2b                 jmp    8048fdf <span class="token operator">&lt;</span>fun7<span class="token operator">+</span><span class="token number">0x61</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="21"></td><td><pre> 8048fb4: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="22"></td><td><pre> 8048fb7: 8b <span class="token number">00</span>                 mov    (<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="23"></td><td><pre> 8048fb9: 3b <span class="token number">45</span> 0c              cmp    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="24"></td><td><pre> 8048fbc: <span class="token number">75</span> <span class="token number">07</span>                 jne    8048fc5 <span class="token operator">&lt;</span>fun7<span class="token operator">+</span><span class="token number">0x47</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="25"></td><td><pre> 8048fbe: b8 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>        mov    <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="26"></td><td><pre> 8048fc3: eb 1a                 jmp    8048fdf <span class="token operator">&lt;</span>fun7<span class="token operator">+</span><span class="token number">0x61</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="27"></td><td><pre> 8048fc5: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="28"></td><td><pre> 8048fc8: 8b <span class="token number">40</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="29"></td><td><pre> 8048fcb: 8b <span class="token number">55</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="30"></td><td><pre> 8048fce: <span class="token number">89</span> <span class="token number">54</span> <span class="token number">24</span> <span class="token number">04</span>           mov    <span class="token operator">%</span><span class="token register variable">edx</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="31"></td><td><pre> 8048fd2: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="32"></td><td><pre> 8048fd5: e8 a4 ff ff ff        call   8048f7e <span class="token operator">&lt;</span>fun7<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="33"></td><td><pre> 8048fda: <span class="token number">01</span> c0                 add    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="34"></td><td><pre> 8048fdc: <span class="token number">83</span> c0 <span class="token number">01</span>              add    <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="35"></td><td><pre> 8048fdf: c9                    leave</pre></td></tr><tr><td data-num="36"></td><td><pre> 8048fe0: c3                    ret</pre></td></tr></tbody></table></figure><p>观察输入的第一个参数 <code>0x804c198</code>  周围的数据，我们发现其基本结构单元是：</p>
<ol>
<li>一个数值</li>
<li>一个地址</li>
<li>一个地址</li>
</ol>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>(gdb) x <span class="token operator">/</span>45wx <span class="token number">0x804c0f0</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">0x804c0f0</span> <span class="token operator">&lt;</span>n48<span class="token operator">&gt;</span>:        <span class="token number">0x000003e9</span>      <span class="token number">0x00000000</span>      <span class="token number">0x00000000</span>      <span class="token number">0x0000002f</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token number">0x804c100</span> <span class="token operator">&lt;</span>n46<span class="token operator">+</span><span class="token number">4</span><span class="token operator">&gt;</span>:      <span class="token number">0x00000000</span>      <span class="token number">0x00000000</span>      <span class="token number">0x00000014</span>      <span class="token number">0x00000000</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token number">0x804c110</span> <span class="token operator">&lt;</span>n43<span class="token operator">+</span><span class="token number">8</span><span class="token operator">&gt;</span>:      <span class="token number">0x00000000</span>      <span class="token number">0x00000007</span>      <span class="token number">0x00000000</span>      <span class="token number">0x00000000</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token number">0x804c120</span> <span class="token operator">&lt;</span>n44<span class="token operator">&gt;</span>:        <span class="token number">0x00000023</span>      <span class="token number">0x00000000</span>      <span class="token number">0x00000000</span>      <span class="token number">0x00000063</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token number">0x804c130</span> <span class="token operator">&lt;</span>n47<span class="token operator">+</span><span class="token number">4</span><span class="token operator">&gt;</span>:      <span class="token number">0x00000000</span>      <span class="token number">0x00000000</span>      <span class="token number">0x00000001</span>      <span class="token number">0x00000000</span></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token number">0x804c140</span> <span class="token operator">&lt;</span>n41<span class="token operator">+</span><span class="token number">8</span><span class="token operator">&gt;</span>:      <span class="token number">0x00000000</span>      <span class="token number">0x00000028</span>      <span class="token number">0x00000000</span>      <span class="token number">0x00000000</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token number">0x804c150</span> <span class="token operator">&lt;</span>n34<span class="token operator">&gt;</span>:        <span class="token number">0x0000006b</span>      <span class="token number">0x0804c12c</span>      <span class="token number">0x0804c0f0</span>      <span class="token number">0x00000006</span></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token number">0x804c160</span> <span class="token operator">&lt;</span>n31<span class="token operator">+</span><span class="token number">4</span><span class="token operator">&gt;</span>:      <span class="token number">0x0804c138</span>      <span class="token number">0x0804c114</span>      <span class="token number">0x0000002d</span>      <span class="token number">0x0804c144</span></pre></td></tr><tr><td data-num="10"></td><td><pre><span class="token number">0x804c170</span> <span class="token operator">&lt;</span>n33<span class="token operator">+</span><span class="token number">8</span><span class="token operator">&gt;</span>:      <span class="token number">0x0804c0fc</span>      <span class="token number">0x00000016</span>      <span class="token number">0x0804c108</span>      <span class="token number">0x0804c120</span></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token number">0x804c180</span> <span class="token operator">&lt;</span>n22<span class="token operator">&gt;</span>:        <span class="token number">0x00000032</span>      <span class="token number">0x0804c168</span>      <span class="token number">0x0804c150</span>      <span class="token number">0x00000008</span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token number">0x804c190</span> <span class="token operator">&lt;</span>n21<span class="token operator">+</span><span class="token number">4</span><span class="token operator">&gt;</span>:      <span class="token number">0x0804c15c</span>      <span class="token number">0x0804c174</span>      <span class="token number">0x00000024</span>      <span class="token number">0x0804c18c</span></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token number">0x804c1a0</span> <span class="token operator">&lt;</span>n1<span class="token operator">+</span><span class="token number">8</span><span class="token operator">&gt;</span>:       <span class="token number">0x0804c180</span></pre></td></tr></tbody></table></figure><p>这种结构很像我们在数据结构课程中学过的二叉树，我们尝试把这颗树画出来：</p>
<p><img loading="lazy" data-src="https://s2.loli.net/2023/05/13/1eu74OYHViIUsyv.png" alt=""></p>
<p>在知道了第一个参数输入的是二叉树的头节点时，我们接下来对于 <code>fun7</code>  所做的事也就有了更加明确的认知。<br>
 <code>fun7</code>  同样是一个递归函数，该函数接受一个指向二叉树节点的指针和一个整数作为参数，并返回一个整数值。<br>
如果节点指针为 NULL，则函数返回 - 1。<br>
否则，它将节点的值与第二个参数进行比较。<br>
如果节点的值大于第二个参数，则函数递归调用自身，将当前节点的左子节点和第二个参数作为新的参数，并将其返回值乘以 2 作为新的返回值返回。<br>
如果节点的值等于第二个参数，则函数返回 0。<br>
否则，函数递归调用自身，将该节点的右子节点和第二个参数作为新参数，并将返回值乘以 2 再加 1 作为新的返回值返回。</p>
<p>因此 <code>fun7</code>  可以抽象为以下的式子：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mi>u</mi><mi>n</mi><mn>7</mn><mo stretchy="false">(</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if&nbsp;</mtext><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mo>=</mo><mi>N</mi><mi>U</mi><mi>L</mi><mi>L</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>2</mn><mo>×</mo><mi>f</mi><mi>u</mi><mi>n</mi><mn>7</mn><mo stretchy="false">(</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi mathvariant="normal">.</mi><mi>l</mi><mi>e</mi><mi>f</mi><mi>t</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if&nbsp;</mtext><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi mathvariant="normal">.</mi><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>&gt;</mo><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if&nbsp;</mtext><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi mathvariant="normal">.</mi><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>=</mo><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>2</mn><mo>×</mo><mi>f</mi><mi>u</mi><mi>n</mi><mn>7</mn><mo stretchy="false">(</mo><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi mathvariant="normal">.</mi><mi>r</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo separator="true">,</mo><mi>x</mi><mo stretchy="false">)</mo><mo>+</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>if&nbsp;</mtext><mi>n</mi><mi>o</mi><mi>d</mi><mi>e</mi><mi mathvariant="normal">.</mi><mi>v</mi><mi>a</mi><mi>l</mi><mi>u</mi><mi>e</mi><mo>&lt;</mo><mi>x</mi></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex"> fun7(node, x) =
    \begin{cases}
    -1 &amp; \text{if } node = NULL \\
    2 \times fun7(node.left, x) &amp; \text{if } node.value &gt; x \\
    0 &amp; \text{if } node.value = x \\
    2 \times fun7(node.right, x) + 1 &amp; \text{if } node.value &lt; x
\end{cases} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord">7</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:5.76em;vertical-align:-2.63em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.95em;"><span style="top:-1.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-1.592em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.916em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.916em" style="width:0.8889em" viewBox="0 0 888.89 916" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V916 H384z M384 0 H504 V916 H384z"></path></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.916em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.916em" style="width:0.8889em" viewBox="0 0 888.89 916" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V916 H384z M384 0 H504 V916 H384z"></path></svg></span></span><span style="top:-5.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.45em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.13em;"><span style="top:-5.13em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mord">1</span></span></span><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord">7</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0</span></span></span><span style="top:-0.81em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">u</span><span class="mord mathnormal">n</span><span class="mord">7</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.63em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:3.13em;"><span style="top:-5.13em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal">ULL</span></span></span><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span></span></span><span style="top:-0.81em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord">if&nbsp;</span></span><span class="mord mathnormal">n</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord">.</span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">u</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord mathnormal">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.63em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>我们需要的返回值是 7。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>7</mn><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mn>0</mn><mo>∗</mo><mn>2</mn><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>∗</mo><mn>2</mn><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo><mo>∗</mo><mn>2</mn><mo>+</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">7=(((0 \ast 2+1) \ast 2+1) \ast 2+1) 
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">7</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(((</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p>
<table>
<thead>
<tr></tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">*2+1</td>
<td style="text-align:center">right</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">*2+1</td>
<td style="text-align:center">right</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">*2+1</td>
<td style="text-align:center">right</td>
</tr>
</tbody>
</table>
<p>再根据我们之前画出的二叉树，可以得到我们所需要的之是 1001。<br>
<img loading="lazy" data-src="https://s2.loli.net/2023/05/13/le6MFcYXUhLuZjQ.png" alt=""></p>
<h1 id="read_six_number"><a class="anchor" href="#read_six_number">#</a> read_six_number</h1>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>080490c5 <span class="token operator">&lt;</span>read_six_numbers<span class="token operator">&gt;</span>:</pre></td></tr><tr><td data-num="2"></td><td><pre> 80490c5: <span class="token number">55</span>                    push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="3"></td><td><pre> 80490c6: <span class="token number">89</span> e5                 mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre> 80490c8: <span class="token number">56</span>                    push   <span class="token operator">%</span><span class="token register variable">esi</span></pre></td></tr><tr><td data-num="5"></td><td><pre> 80490c9: <span class="token number">53</span>                    push   <span class="token operator">%</span><span class="token register variable">ebx</span></pre></td></tr><tr><td data-num="6"></td><td><pre> 80490ca: <span class="token number">83</span> ec <span class="token number">30</span>              sub    <span class="token operator">$</span><span class="token number">0x30</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="7"></td><td><pre> 80490cd: 8b <span class="token number">45</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="8"></td><td><pre> 80490d0: <span class="token number">8d</span> <span class="token number">70</span> <span class="token number">14</span>              lea    <span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">esi</span></pre></td></tr><tr><td data-num="9"></td><td><pre> 80490d3: 8b <span class="token number">45</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="10"></td><td><pre> 80490d6: <span class="token number">8d</span> <span class="token number">58</span> <span class="token number">10</span>              lea    <span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">ebx</span></pre></td></tr><tr><td data-num="11"></td><td><pre> 80490d9: 8b <span class="token number">45</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="12"></td><td><pre> 80490dc: <span class="token number">8d</span> <span class="token number">48</span> 0c              lea    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">ecx</span></pre></td></tr><tr><td data-num="13"></td><td><pre> 80490df: 8b <span class="token number">45</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="14"></td><td><pre> <span class="token number">80490e2</span>: <span class="token number">8d</span> <span class="token number">50</span> <span class="token number">08</span>              lea    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="15"></td><td><pre> <span class="token number">80490e5</span>: 8b <span class="token number">45</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="16"></td><td><pre> <span class="token number">80490e8</span>: <span class="token number">83</span> c0 <span class="token number">04</span>              add    <span class="token operator">$</span><span class="token number">0x4</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="17"></td><td><pre> 80490eb: <span class="token number">89</span> <span class="token number">74</span> <span class="token number">24</span> 1c           mov    <span class="token operator">%</span><span class="token register variable">esi</span>,<span class="token number">0x1c</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="18"></td><td><pre> 80490ef: <span class="token number">89</span> 5c <span class="token number">24</span> <span class="token number">18</span>           mov    <span class="token operator">%</span><span class="token register variable">ebx</span>,<span class="token number">0x18</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="19"></td><td><pre> 80490f3: <span class="token number">89</span> 4c <span class="token number">24</span> <span class="token number">14</span>           mov    <span class="token operator">%</span><span class="token register variable">ecx</span>,<span class="token number">0x14</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="20"></td><td><pre> 80490f7: <span class="token number">89</span> <span class="token number">54</span> <span class="token number">24</span> <span class="token number">10</span>           mov    <span class="token operator">%</span><span class="token register variable">edx</span>,<span class="token number">0x10</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="21"></td><td><pre> 80490fb: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> 0c           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="22"></td><td><pre> 80490ff: 8b <span class="token number">45</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="23"></td><td><pre> <span class="token number">8049102</span>: <span class="token number">89</span> <span class="token number">44</span> <span class="token number">24</span> <span class="token number">08</span>           mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="24"></td><td><pre> <span class="token number">8049106</span>: c7 <span class="token number">44</span> <span class="token number">24</span> <span class="token number">04</span> <span class="token number">7d</span> a4 <span class="token number">04</span>  movl   <span class="token operator">$</span><span class="token number">0x804a47d</span>,<span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="25"></td><td><pre> <span class="token number">804910d</span>: <span class="token number">08</span> </pre></td></tr><tr><td data-num="26"></td><td><pre> 804910e: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="27"></td><td><pre> <span class="token number">8049111</span>: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="28"></td><td><pre> <span class="token number">8049114</span>: e8 <span class="token number">77</span> f7 ff ff        call   <span class="token number">8048890</span> <span class="token operator">&lt;</span>__isoc99_sscanf@plt<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="29"></td><td><pre> <span class="token number">8049119</span>: <span class="token number">89</span> <span class="token number">45</span> f4              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="30"></td><td><pre> 804911c: <span class="token number">83</span> <span class="token number">7d</span> f4 <span class="token number">05</span>           cmpl   <span class="token operator">$</span><span class="token number">0x5</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="31"></td><td><pre> <span class="token number">8049120</span>: 7f <span class="token number">05</span>                 jg     <span class="token number">8049127</span> <span class="token operator">&lt;</span>read_six_numbers<span class="token operator">+</span><span class="token number">0x62</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="32"></td><td><pre> <span class="token number">8049122</span>: e8 <span class="token number">96</span> <span class="token number">02</span> <span class="token number">00</span> <span class="token number">00</span>        call   80493bd <span class="token operator">&lt;</span>explode_bomb<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="33"></td><td><pre> <span class="token number">8049127</span>: <span class="token number">83</span> c4 <span class="token number">30</span>              add    <span class="token operator">$</span><span class="token number">0x30</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="34"></td><td><pre> 804912a: 5b                    pop    <span class="token operator">%</span><span class="token register variable">ebx</span></pre></td></tr><tr><td data-num="35"></td><td><pre> 804912b: 5e                    pop    <span class="token operator">%</span><span class="token register variable">esi</span></pre></td></tr><tr><td data-num="36"></td><td><pre> 804912c: <span class="token number">5d</span>                    pop    <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="37"></td><td><pre> <span class="token number">804912d</span>: c3                    ret</pre></td></tr></tbody></table></figure><figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>(gdb) x <span class="token operator">/</span>s <span class="token number">0x804a47d</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token number">0x804a47d</span>:      <span class="token string">"%d %d %d %d %d %d"</span></pre></td></tr></tbody></table></figure><p>该函数的作用是从标准输入中读取六个整数，调整栈指针为这些变量分配所需的空间，然后调用了 <code>__isoc99_sscanf@plt</code>  函数，与我们平常使用的 <code>sscanf</code>  相似， <code>0x804a47d</code>  地址所存放的就是格式字符串，最后，检查所调用函数返回值是否大于 5，若小于五则调用 <code>explode_bomb</code> ，炸弹直接爆炸。</p>
<h1 id="string_length"><a class="anchor" href="#string_length">#</a> string_length</h1>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>0804912e <span class="token operator">&lt;</span>string_length<span class="token operator">&gt;</span>:</pre></td></tr><tr><td data-num="2"></td><td><pre> 804912e: <span class="token number">55</span>                    push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="3"></td><td><pre> 804912f: <span class="token number">89</span> e5                 mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre> <span class="token number">8049131</span>: <span class="token number">83</span> ec <span class="token number">10</span>              sub    <span class="token operator">$</span><span class="token number">0x10</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="5"></td><td><pre> <span class="token number">8049134</span>: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="6"></td><td><pre> <span class="token number">8049137</span>: <span class="token number">89</span> <span class="token number">45</span> f8              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="7"></td><td><pre> 804913a: c7 <span class="token number">45</span> fc <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>  movl   <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token operator">-</span><span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="8"></td><td><pre> <span class="token number">8049141</span>: eb <span class="token number">08</span>                 jmp    804914b <span class="token operator">&lt;</span>string_length<span class="token operator">+</span><span class="token number">0x1d</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="9"></td><td><pre> <span class="token number">8049143</span>: <span class="token number">83</span> <span class="token number">45</span> f8 <span class="token number">01</span>           addl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="10"></td><td><pre> <span class="token number">8049147</span>: <span class="token number">83</span> <span class="token number">45</span> fc <span class="token number">01</span>           addl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="11"></td><td><pre> 804914b: 8b <span class="token number">45</span> f8              mov    <span class="token operator">-</span><span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="12"></td><td><pre> 804914e: 0f b6 <span class="token number">00</span>              movzbl (<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="13"></td><td><pre> <span class="token number">8049151</span>: <span class="token number">84</span> c0                 test   <span class="token operator">%</span><span class="token register variable">al</span>,<span class="token operator">%</span><span class="token register variable">al</span></pre></td></tr><tr><td data-num="14"></td><td><pre> <span class="token number">8049153</span>: <span class="token number">75</span> ee                 jne    <span class="token number">8049143</span> <span class="token operator">&lt;</span>string_length<span class="token operator">+</span><span class="token number">0x15</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="15"></td><td><pre> <span class="token number">8049155</span>: 8b <span class="token number">45</span> fc              mov    <span class="token operator">-</span><span class="token number">0x4</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="16"></td><td><pre> <span class="token number">8049158</span>: c9                    leave</pre></td></tr><tr><td data-num="17"></td><td><pre> <span class="token number">8049159</span>: c3                    ret</pre></td></tr></tbody></table></figure><p>是一个简单的循环结构，每次迭代都会检查字符串中的下一个字符是否为 <code>'\0'</code> （字符串末尾）若不是，则递增字符串指针和长度，直到碰到 <code>'\0'</code> ，退出循环并返回长度。</p>
<h1 id="string_not_equal"><a class="anchor" href="#string_not_equal">#</a> string_not_equal</h1>
<figure class="highlight nasm"><figcaption data-lang="NASM"></figcaption><table><tbody><tr><td data-num="1"></td><td><pre>0804915a <span class="token operator">&lt;</span>strings_not_equal<span class="token operator">&gt;</span>:</pre></td></tr><tr><td data-num="2"></td><td><pre> 804915a: <span class="token number">55</span>                    push   <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="3"></td><td><pre> 804915b: <span class="token number">89</span> e5                 mov    <span class="token operator">%</span><span class="token register variable">esp</span>,<span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="4"></td><td><pre> <span class="token number">804915d</span>: <span class="token number">53</span>                    push   <span class="token operator">%</span><span class="token register variable">ebx</span></pre></td></tr><tr><td data-num="5"></td><td><pre> 804915e: <span class="token number">83</span> ec <span class="token number">14</span>              sub    <span class="token operator">$</span><span class="token number">0x14</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="6"></td><td><pre> <span class="token number">8049161</span>: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="7"></td><td><pre> <span class="token number">8049164</span>: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="8"></td><td><pre> <span class="token number">8049167</span>: e8 c2 ff ff ff        call   804912e <span class="token operator">&lt;</span>string_length<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="9"></td><td><pre> 804916c: <span class="token number">89</span> c3                 mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">%</span><span class="token register variable">ebx</span></pre></td></tr><tr><td data-num="10"></td><td><pre> 804916e: 8b <span class="token number">45</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="11"></td><td><pre> <span class="token number">8049171</span>: <span class="token number">89</span> <span class="token number">04</span> <span class="token number">24</span>              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,(<span class="token operator">%</span><span class="token register variable">esp</span>)</pre></td></tr><tr><td data-num="12"></td><td><pre> <span class="token number">8049174</span>: e8 b5 ff ff ff        call   804912e <span class="token operator">&lt;</span>string_length<span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="13"></td><td><pre> <span class="token number">8049179</span>: <span class="token number">39</span> c3                 cmp    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">%</span><span class="token register variable">ebx</span></pre></td></tr><tr><td data-num="14"></td><td><pre> 804917b: <span class="token number">74</span> <span class="token number">07</span>                 je     <span class="token number">8049184</span> <span class="token operator">&lt;</span>strings_not_equal<span class="token operator">+</span><span class="token number">0x2a</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="15"></td><td><pre> <span class="token number">804917d</span>: b8 <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>        mov    <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="16"></td><td><pre> <span class="token number">8049182</span>: eb 3c                 jmp    80491c0 <span class="token operator">&lt;</span>strings_not_equal<span class="token operator">+</span><span class="token number">0x66</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="17"></td><td><pre> <span class="token number">8049184</span>: 8b <span class="token number">45</span> <span class="token number">08</span>              mov    <span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="18"></td><td><pre> <span class="token number">8049187</span>: <span class="token number">89</span> <span class="token number">45</span> f8              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="19"></td><td><pre> 804918a: 8b <span class="token number">45</span> 0c              mov    <span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="20"></td><td><pre> <span class="token number">804918d</span>: <span class="token number">89</span> <span class="token number">45</span> f4              mov    <span class="token operator">%</span><span class="token register variable">eax</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="21"></td><td><pre> <span class="token number">8049190</span>: eb 1f                 jmp    80491b1 <span class="token operator">&lt;</span>strings_not_equal<span class="token operator">+</span><span class="token number">0x57</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="22"></td><td><pre> <span class="token number">8049192</span>: 8b <span class="token number">45</span> f8              mov    <span class="token operator">-</span><span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="23"></td><td><pre> <span class="token number">8049195</span>: 0f b6 <span class="token number">10</span>              movzbl (<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">edx</span></pre></td></tr><tr><td data-num="24"></td><td><pre> <span class="token number">8049198</span>: 8b <span class="token number">45</span> f4              mov    <span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="25"></td><td><pre> 804919b: 0f b6 <span class="token number">00</span>              movzbl (<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="26"></td><td><pre> 804919e: <span class="token number">38</span> c2                 cmp    <span class="token operator">%</span><span class="token register variable">al</span>,<span class="token operator">%</span><span class="token register variable">dl</span></pre></td></tr><tr><td data-num="27"></td><td><pre> 80491a0: <span class="token number">74</span> <span class="token number">07</span>                 je     80491a9 <span class="token operator">&lt;</span>strings_not_equal<span class="token operator">+</span><span class="token number">0x4f</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="28"></td><td><pre> 80491a2: b8 <span class="token number">01</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>        mov    <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="29"></td><td><pre> 80491a7: eb <span class="token number">17</span>                 jmp    80491c0 <span class="token operator">&lt;</span>strings_not_equal<span class="token operator">+</span><span class="token number">0x66</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="30"></td><td><pre> 80491a9: <span class="token number">83</span> <span class="token number">45</span> f8 <span class="token number">01</span>           addl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="31"></td><td><pre> 80491ad: <span class="token number">83</span> <span class="token number">45</span> f4 <span class="token number">01</span>           addl   <span class="token operator">$</span><span class="token number">0x1</span>,<span class="token operator">-</span><span class="token number">0xc</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>)</pre></td></tr><tr><td data-num="32"></td><td><pre> 80491b1: 8b <span class="token number">45</span> f8              mov    <span class="token operator">-</span><span class="token number">0x8</span>(<span class="token operator">%</span><span class="token register variable">ebp</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="33"></td><td><pre> 80491b4: 0f b6 <span class="token number">00</span>              movzbl (<span class="token operator">%</span><span class="token register variable">eax</span>),<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="34"></td><td><pre> 80491b7: <span class="token number">84</span> c0                 test   <span class="token operator">%</span><span class="token register variable">al</span>,<span class="token operator">%</span><span class="token register variable">al</span></pre></td></tr><tr><td data-num="35"></td><td><pre> 80491b9: <span class="token number">75</span> d7                 jne    <span class="token number">8049192</span> <span class="token operator">&lt;</span>strings_not_equal<span class="token operator">+</span><span class="token number">0x38</span><span class="token operator">&gt;</span></pre></td></tr><tr><td data-num="36"></td><td><pre> 80491bb: b8 <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span> <span class="token number">00</span>        mov    <span class="token operator">$</span><span class="token number">0x0</span>,<span class="token operator">%</span><span class="token register variable">eax</span></pre></td></tr><tr><td data-num="37"></td><td><pre> 80491c0: <span class="token number">83</span> c4 <span class="token number">14</span>              add    <span class="token operator">$</span><span class="token number">0x14</span>,<span class="token operator">%</span><span class="token register variable">esp</span></pre></td></tr><tr><td data-num="38"></td><td><pre> 80491c3: 5b                    pop    <span class="token operator">%</span><span class="token register variable">ebx</span></pre></td></tr><tr><td data-num="39"></td><td><pre> 80491c4: <span class="token number">5d</span>                    pop    <span class="token operator">%</span><span class="token register variable">ebp</span></pre></td></tr><tr><td data-num="40"></td><td><pre> 80491c5: c3                    ret</pre></td></tr></tbody></table></figure><p>首先对于输入的两个字符串，调用 <code>string_length</code>  函数，返回两个字符串的长度，若长度不相等则直接返回 1（不相等），如果长度相等，则逐个比较两个字符串中的字符。如果发现不同的字符，则返回 1。如果所有字符都相同，则返回 0。</p>
<div class="tags"><a href="/tags/Reverse-Engineering/" rel="tag"><i class="ic i-tag"></i>Reverse-Engineering</a><a href="/tags/Assembly/" rel="tag"><i class="ic i-tag"></i>Assembly</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i></span><span class="text">更新于</span><time title="修改时间：2023-05-14 16:07:24" itemprop="dateModified" datetime="2023-05-14T16:07:24+08:00">2023-05-14</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者：</strong>Murlors<i class="ic i-at"><em>@</em></i>MurlorsのBlog</li><li class="link"><strong>本文链接：</strong><a href="https://murlors.netlify.app/computer-science/reverse-engineering/binary-bombs/" title="Binary Bombs | 二进制炸弹">https://murlors.netlify.app/computer-science/reverse-engineering/binary-bombs/</a></li><li class="license"><strong>版权声明：</strong>本站所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/computer-science/deeplearning/papersnotes/alexnet/" rel="prev" itemprop="url" data-background-image="https://t.alcy.cc/moe/?postId=48" title="AlexNet论文笔记"><span class="type">上一篇</span><span class="category"><i class="ic i-flag"></i>论文笔记</span><h3>AlexNet论文笔记</h3></a></div><div class="item right"><a href="/hello-world/" rel="next" itemprop="url" data-background-image="https://t.alcy.cc/moe/?postId=26" title="Hello World"><span class="type">下一篇</span><h3>Hello World</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C"><span class="toc-number">1.</span> <span class="toc-text"> 准备工作</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#phase_1"><span class="toc-number">2.</span> <span class="toc-text"> phase_1</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#phase_2"><span class="toc-number">3.</span> <span class="toc-text"> phase_2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#phase_3"><span class="toc-number">4.</span> <span class="toc-text"> phase_3</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#phase_4"><span class="toc-number">5.</span> <span class="toc-text"> phase_4</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#phase_5"><span class="toc-number">6.</span> <span class="toc-text"> phase_5</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#phase_6"><span class="toc-number">7.</span> <span class="toc-text"> phase_6</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#phase_defused"><span class="toc-number">8.</span> <span class="toc-text"> phase_defused</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#secret_phase"><span class="toc-number">9.</span> <span class="toc-text"> secret_phase</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#read_six_number"><span class="toc-number">10.</span> <span class="toc-text"> read_six_number</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#string_length"><span class="toc-number">11.</span> <span class="toc-text"> string_length</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#string_not_equal"><span class="toc-number">12.</span> <span class="toc-text"> string_not_equal</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/computer-science/reverse-engineering/binary-bombs/" rel="bookmark" title="Binary Bombs | 二进制炸弹">Binary Bombs | 二进制炸弹</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><img class="image" loading="lazy" decoding="async" itemprop="image" alt="Murlors" src="/assets/avatar.webp"><p class="name" itemprop="name">Murlors</p><div class="description" itemprop="description">Hi, I'm Murlors.</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">14</span><span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">14</span><span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">19</span><span class="name">标签</span></a></div></nav><div class="social"><a target="_blank" rel="noopener" href="https://github.com/Murlors" class="item github" title="https://github.com/Murlors"><i class="ic i-github"></i></a><a target="_blank" rel="noopener" href="https://www.zhihu.com/people/hu1595258509" class="item zhihu" title="https://www.zhihu.com/people/hu1595258509"><i class="ic i-zhihu"></i></a><a target="_blank" rel="noopener" href="https://space.bilibili.com/62859865" class="item bilibili" title="https://space.bilibili.com/62859865"><i class="ic i-bilibili"></i></a><a target="_blank" rel="noopener" href="https://music.163.com/#/user/home?id=435589630" class="item music" title="https://music.163.com/#/user/home?id=435589630"><i class="ic i-cloud-music"></i></a><a href="mailto:murlors@foxmail.com" class="item email" title="mailto:murlors@foxmail.com"><i class="ic i-envelope"></i></a><a target="_blank" rel="noopener" href="http://wpa.qq.com/msgrd?v=3&amp;uin=1595258509" class="item qq" title="http://wpa.qq.com/msgrd?v=3&amp;uin=1595258509"><i class="ic i-qq"></i></a></div><div class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="#" onclick="return false;"><i class="ic i-user"></i>关于</a><ul class="submenu"><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于本站</a></li><li class="item"><a href="/about/aboutme" rel="section"><i class="ic i-user"></i>个人简介</a></li><li class="item"><a href="/about/hobby" rel="section"><i class="ic i-heart"></i>兴趣爱好</a></li><li class="item"><a href="/about/hometown" rel="section"><i class="ic i-home"></i>我的家乡</a></li><li class="item"><a href="/about/collegelive" rel="section"><i class="ic i-sakura"></i>校园活动</a></li></ul></li><li class="item dropdown"><a href="#" onclick="return false;"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li></div></div></div></div><ul id="quick"><li class="prev pjax"><a href="/hello-world/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/computer-science/deeplearning/papersnotes/alexnet/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于计算机科学">计算机科学</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/" title="分类于二进制杂谈">二进制杂谈</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/%E5%B0%8F%E6%B8%A9%E6%96%B0%E5%9B%BE%E5%BA%93/" title="分类于小温新图库">小温新图库</a></div><span><a href="/computer-science/note/xiaowenxin-gallery/use-tutorial-brief/">小温新图库使用教程(简)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于计算机科学">计算机科学</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/" title="分类于二进制杂谈">二进制杂谈</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/Theme-Shoka-Documentation/" title="分类于Theme Shoka Documentation">Theme Shoka Documentation</a></div><span><a href="/computer-science/note/theme-shoka-doc/">Hexo主题Shoka &amp; multi-markdown-it渲染器使用说明</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于计算机科学">计算机科学</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/Linux/" title="分类于Linux">Linux</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/Linux/CentOS/" title="分类于CentOS">CentOS</a></div><span><a href="/computer-science/linux/centos/virtualbox-ssh-connection-configuration/">CentOS7 VirtualBox SSH连接配置</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于计算机科学">计算机科学</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/" title="分类于二进制杂谈">二进制杂谈</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/%E9%BB%91%E8%8B%B9%E6%9E%9C/" title="分类于黑苹果">黑苹果</a></div><span><a href="/computer-science/note/hackintosh/lenovo-y40-70-crack-white-list-guide/">联想Y40-70破解白名单教程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于计算机科学">计算机科学</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/" title="分类于二进制杂谈">二进制杂谈</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/%E9%BB%91%E8%8B%B9%E6%9E%9C/" title="分类于黑苹果">黑苹果</a></div><span><a href="/computer-science/note/hackintosh/lenovo-y40-70-laptop-mac-os-guide-and-efi-share/">联想Y40-70笔记本电脑安装MacOS教程及EFI分享</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于计算机科学">计算机科学</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/" title="分类于二进制杂谈">二进制杂谈</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/Theme-Shoka-Documentation/" title="分类于Theme Shoka Documentation">Theme Shoka Documentation</a></div><span><a href="/computer-science/note/theme-shoka-doc/config/">Step.2 基本配置</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于计算机科学">计算机科学</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/Java/" title="分类于Java">Java</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/Java/%E9%9B%B6%E5%9F%BA%E7%A1%80%E5%AD%A6Java%E8%AF%AD%E8%A8%80-%E6%B5%99%E6%B1%9F%E5%A4%A7%E5%AD%A6-%E7%BF%81%E6%81%BA/" title="分类于零基础学Java语言-浙江大学-翁恺">零基础学Java语言-浙江大学-翁恺</a></div><span><a href="/computer-science/java/course-1/week-2/">第2周 判断</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于计算机科学">计算机科学</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/DeepLearing/" title="分类于DeepLearing">DeepLearing</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/DeepLearing/%E8%AE%BA%E6%96%87%E7%AC%94%E8%AE%B0/" title="分类于论文笔记">论文笔记</a></div><span><a href="/computer-science/deeplearning/papersnotes/alexnet/">AlexNet论文笔记</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于计算机科学">计算机科学</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/" title="分类于二进制杂谈">二进制杂谈</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/Theme-Shoka-Documentation/" title="分类于Theme Shoka Documentation">Theme Shoka Documentation</a></div><span><a href="/computer-science/note/theme-shoka-doc/dependents/">Step.1 依赖插件</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="分类于计算机科学">计算机科学</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/" title="分类于二进制杂谈">二进制杂谈</a><i class="ic i-angle-right"></i><a href="/categories/computer-science/%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%9D%82%E8%B0%88/Theme-Shoka-Documentation/" title="分类于Theme Shoka Documentation">Theme Shoka Documentation</a></div><span><a href="/computer-science/note/theme-shoka-doc/display/">Step.3 界面显示</a></span></li></ul></div></div><div class="status"><div class="copyright">© 2018 -<span itemprop="copyrightYear">2024</span><span class="with-love"><i class="ic i-sakura rotate"></i></span><span class="author" itemprop="copyrightHolder">Murlors @ Murlors</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i></span><span title="站点总字数">100k 字</span><span class="post-meta-divider"> | </span><span class="post-meta-item-icon"><i class="ic i-coffee"></i></span><span title="站点阅读时长">1:31</span></div><div class="powered-by">基于 <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> &amp; Theme.<a target="_blank" rel="noopener" href="https://github.com/theme-shoka-x/hexo-theme-shokaX/">ShokaX</a></div></div></div></footer></div><script data-config="" type="text/javascript">var LOCAL = {
    ispost: true,
        path: `computer-science/reverse-engineering/binary-bombs/`,
        favicon: {
        show: `（●´3｀●）やれやれだぜ`,
        hide: `(´Д｀)大変だ！`
    },
    search: {
        placeholder: "文章搜索",
        empty: "关于 「 ${query} 」，什么也没搜到",
        stats: "${time} ms 内找到 ${hits} 条结果"
    },
    copy_tex: true,
    katex: true,
    mermaid: false,
    audio: undefined,
    fancybox: true,
    nocopy: false,
    outime: true,
    template: `<div class="note warning"><p><span class="label warning">文章时效性提示</span><br>这是一篇发布于 {{publish}} 天前，最后一次更新在 {{updated}} 天前的文章，部分信息可能已经发生改变，请注意甄别。</p></div>`,
    quiz: {
        choice: `单选题`,
        multiple: `多选题`,
        true_false: `判断题`,
        essay: `问答题`,
        gap_fill: `填空题`,
        mistake: `错题备注`
    },
    ignores: [
        (uri) => uri.includes('#'),
        (uri) => new RegExp(LOCAL.path + '$').test(uri),
            []
    ]
};
</script><script src="https://lf9-cdn-tos.bytecdntp.com/cdn/expire-6-M/pace/1.2.4/pace.min.js" async=""></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?version=4.8.0&amp;features=default,fetch" defer=""></script><script src="/js/siteInit.js?v=0.4.5" type="module" fetchpriority="high" defer=""></script></body></html>